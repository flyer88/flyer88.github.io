<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://flyer88.github.io</id>
    <title>é”®ç›˜æ•²å‡»è€…</title>
    <updated>2020-06-17T08:00:51.417Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://flyer88.github.io"/>
    <link rel="self" href="https://flyer88.github.io/atom.xml"/>
    <subtitle>çˆªå“‡å²›ä¸Šç¨‹åºçŒ¿ åæŒ‡å¼¯å¼¯ä¸å¼„å¼¦ 
æ–—å®¤æ–¹å±åä½™å¯¸ ä¸çŸ¥ä»Šå¤•æ˜¯ä½•å¹´</subtitle>
    <logo>https://flyer88.github.io/images/avatar.png</logo>
    <icon>https://flyer88.github.io/favicon.ico</icon>
    <rights>All rights reserved 2020, é”®ç›˜æ•²å‡»è€…</rights>
    <entry>
        <title type="html"><![CDATA[å…³äº OOM]]></title>
        <id>https://flyer88.github.io/post/guan-yu-oom/</id>
        <link href="https://flyer88.github.io/post/guan-yu-oom/">
        </link>
        <updated>2020-06-17T07:58:29.000Z</updated>
        <content type="html"><![CDATA[<ul>
<li><code>OOM</code> ç±»å‹</li>
<li><code>OOM</code> é”™è¯¯åŸå› </li>
<li><code>OOM</code> å®šä½é—®é¢˜</li>
</ul>
<h3 id="0x0001-oom-ç±»å‹">0x0001. <code>OOM</code> ç±»å‹</h3>
<ol>
<li>
<p><strong>Java å †æ ˆæº¢å‡ºï¼Œå¤šæ•°åŸå› æ˜¯å†…å­˜æ³„éœ²æˆ–è€…å›¾ç‰‡è¿‡å¤§</strong></p>
<blockquote>
<p><strong>java.lang.OutOfMemoryError<br>
Failed to allocate a 3225612 byte allocation with 1716008 free bytes and 1675KB until OOM</strong></p>
</blockquote>
</li>
<li>
<p><strong>Java å †æ ˆæº¢å‡ºï¼Œæ­¤ç±» bug æœ€å¥½è®© Glide ä¹‹ç±»çš„å›¾ç‰‡æ¡†æ¶è¿›è¡Œç»Ÿä¸€åŠ è½½å›¾ç‰‡ï¼ŒåŒä¸Š</strong></p>
<blockquote>
<p><strong>java.lang.OutOfMemoryError<br>
OOM allocating scaled Bitmap with dimensions 1056 x 330</strong></p>
</blockquote>
</li>
<li>
<p><strong>è™šæ‹Ÿå†…å­˜ä¸è¶³æˆ–è€…å•ä¸ªè¿›ç¨‹ä¸­çš„çº¿ç¨‹æ•°åˆ°è¾¾ä¸Šé™ï¼ˆå †ä¸­å†…å­˜å……è¶³ï¼Œå´ OOMï¼Œå‰è€…å¯èƒ½æ€§æå°å¿½ç•¥ï¼‰</strong></p>
<blockquote>
<p><strong>java.lang.OutOfMemoryError<br>
pthread_create (1040KB stack) failed: Try again</strong></p>
</blockquote>
</li>
<li>
<p><strong><code>JNI</code> æŠ¥é”™ï¼Œè¿›ç¨‹æ‰“å¼€æ–‡ä»¶æ•°é‡è¾¾ä¸Šé™æˆ–è™šæ‹Ÿå†…å­˜ä¸è¶³ï¼ˆå †ä¸­å†…å­˜å……è¶³ï¼Œå´ OOMï¼Œåè€…å¯èƒ½æ€§æå°å¿½ç•¥ï¼‰</strong></p>
<blockquote>
<p><strong>java.lang.OutOfMemoryError<br>
Could not allocate JNI Env</strong></p>
</blockquote>
</li>
<li>
<p><strong>å› ä¸º OOM å¼•èµ·çš„ OOMï¼Œè§£å†³ä¸Šè¿°ä¸‰ç§é—®é¢˜ï¼ŒåŸºæœ¬å°±ä¸ä¼šå‡ºç°æ­¤ç±» bug</strong></p>
</li>
</ol>
<blockquote>
<p><strong>java.lang.OutOfMemoryError<br>
OutOfMemoryError thrown while trying to throw OutOfMemoryError; no stack trace available</strong></p>
</blockquote>
<h3 id="0x0002-oom-é”™è¯¯åŸå› ">0x0002. <code>OOM</code> é”™è¯¯åŸå› </h3>
<ol>
<li>
<p>æƒ…å†µä¸€ï¼Œå¤šæ•°æƒ…å†µæ˜¯è§£å†³å†…å­˜æ³„éœ²ï¼Œå¯ä»¥å‚è€ƒ<a href="https://flyer88.github.io/post/nei-cun-xie-lu-fen-xi-ding-wei/">å†…å­˜æ³„éœ²åˆ†æå®šä½</a>ï¼Œå…¶æ¬¡æ˜¯å¤§å›¾å¤„ç†</p>
<blockquote>
<p>å¸¸è§å›¾ç‰‡å¤„ç†å°æŠ€å·§</p>
<ol>
<li>Recyclerview å¿«é€Ÿæ»‘åŠ¨æ—¶ï¼Œé’ˆå¯¹9å®«æ ¼ç±» Appï¼Œå¯ä»¥æš‚åœå›¾ç‰‡åŠ è½½ <code>Glide.with(this).pauseRequests()</code></li>
<li>å„ä¸ª <code>View</code> çš„ <code>Background</code> å¦‚æœæ˜¯å›¾ç‰‡ï¼Œæœ€å¥½ä¹Ÿç”¨ <code>Glide</code> ç»Ÿä¸€è½½å…¥</li>
<li>å›¾ç‰‡å°½é‡ç”¨ <code>webp</code></li>
</ol>
</blockquote>
</li>
<li>
<p>æƒ…å†µäºŒï¼Œåªåœ¨ <code>Android 9.0</code> ä»¥ä¸ŠæŠ¥å‡ºï¼Œæ ¸å¿ƒæ˜¯å›¾ç‰‡ç»Ÿä¸€ç”¨ <code>glide</code> ç±»ä¼¼çš„æ¡†æ¶å¤„ç†</p>
<blockquote>
<p>ä¸Šè¿°ä¸¤ç§æƒ…å†µï¼Œç»ˆæåŸå› éƒ½æ˜¯ç”³è¯·çš„å†…å­˜å¤§äº <code>Runtime.getRuntime().maxMemory()</code></p>
</blockquote>
</li>
<li>
<p>æƒ…å†µä¸‰ï¼Œæºäº <code>linux</code> çš„ç³»ç»Ÿå¯¹å•ä¸ªè¿›ç¨‹å¼€å¯çº¿ç¨‹æ•°é‡çš„é™åˆ¶</p>
<p>å¯ä»¥ç›‘æ§ <code>/proc/[pid]/task</code>ï¼Œå®šä½å…·ä½“çº¿ç¨‹æ¥æºï¼Œå…·ä½“åˆ†æå‚è€ƒæ­¤<a href="https://www.jianshu.com/p/e574f0ffdb42">æ–‡ç« </a></p>
<blockquote>
<p><code>/proc/sys/kernel/threads-max</code></p>
<p><strong>è§„å®šäº†æ¯ä¸ªè¿›ç¨‹åˆ›å»ºçº¿ç¨‹æ•°ç›®çš„ä¸Šé™</strong></p>
</blockquote>
<pre><code class="language-java">/**
* è·å– task æ•°é‡
* ç”¨äºè§£å†³çº¿ç¨‹æ•°é‡æš´å¢å¯¼è‡´çš„ OOM
*/
public static int getTaskCount(){
  File taskFile = new File(&quot;/proc/&quot; + Process.myPid() + &quot;/task&quot;);
  File[] files = taskFile.listFiles();
  int length = files.length; 
}
</code></pre>
</li>
<li>
<p>æƒ…å†µå››ï¼Œæºäº <code>linux</code> çš„ç³»ç»Ÿå¯¹å•ä¸ªè¿›ç¨‹èƒ½æ‰“å¼€æ–‡ä»¶æ•°é‡çš„é™åˆ¶</p>
<p>å¯ä»¥ç›‘æ§ <code>/proc/[pid]/fd</code> ï¼Œå®šä½å…·ä½“åŸå› ï¼Œå…·ä½“åˆ†æå‚è€ƒæ­¤<a href="https://www.jianshu.com/p/e574f0ffdb42">æ–‡ç« </a></p>
<blockquote>
<p>å¯¹æ¯” <code>/proc/pid/limits</code> å†…å®¹ï¼Œè·å–  <code>Max open files</code></p>
<p><code>Max open files</code><strong>è¡¨ç¤ºæ¯ä¸ªè¿›ç¨‹æœ€å¤§æ‰“å¼€æ–‡ä»¶çš„æ•°ç›®ï¼Œè¿›ç¨‹æ¯æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶å°±ä¼šäº§ç”Ÿä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ fd</strong>ï¼ˆç›‘æ§ <code>/proc/pid/fd</code> å†…çš„æ–‡ä»¶æ•°å³å¯)</p>
</blockquote>
<pre><code class="language-java">...
/**
* è·å– PD æ•°é‡
* ç”¨äºè§£å†³æ–‡ä»¶æ‰“å¼€æ•°é‡æš´å¢å¯¼è‡´çš„ OOM
*/
public static int getPDCount(){
  File fdFile = new File(&quot;/proc/&quot; + Process.myPid() + &quot;/fd&quot;);
  File[] files = fdFile.listFiles();
  int length = files.length; 
}

public static final String prefix = &quot;Max open files&quot;;
public static String PID_LIMITS =  &quot;cat /proc/&quot; + Process.myPid() + &quot;/limits&quot;;
/**
* è·å–è¿›ç¨‹æ–‡ä»¶é™åˆ¶æ•°é‡
* ç”¨äºè§£å†³æ–‡ä»¶æ‰“å¼€æ•°é‡æš´å¢å¯¼è‡´çš„ OOM
*/
public static String getLimitsInfo() throws IOException {
  Runtime runtime = Runtime.getRuntime();
  java.lang.Process proc = runtime.exec(PID_LIMITS);
  BufferedReader in = new BufferedReader(new InputStreamReader(proc.getInputStream()));
  StringBuffer stringBuffer = new StringBuffer();
  String line = null;
  while ((line = in.readLine()) != null) {
       stringBuffer.append(line);
       if (line.startsWith(prefix)) return line;
  }
  return &quot;&quot;;
}
...

</code></pre>
</li>
<li>
<p>æƒ…å†µäº”ï¼Œè™šæ‹Ÿå†…å­˜åˆ†é…å¤±è´¥(<code>mapp</code> å¤±è´¥)ï¼Œ<a href="https://cloud.tencent.com/developer/article/1071770">å‚è€ƒæ­¤æ–‡</a></p>
</li>
</ol>
<h3 id="0x0003-oom-å®šä½é—®é¢˜">0x0003. <code>OOM</code> å®šä½é—®é¢˜</h3>
<ol>
<li>
<p>çº¿ä¸‹å®šä½ï¼Œç›´æ¥è¿›è¡Œåˆ†æå³å¯</p>
</li>
<li>
<p>çº¿ä¸Šé‡‡é›†å®šä½ï¼Œè¾ƒä¸ºéº»çƒ¦ï¼Œå…·ä½“æ–¹æ¡ˆå¯ä»¥å‚è€ƒ <a href="https://tech.meituan.com/2019/11/14/crash-oom-probe-practice.html">ç¾å›¢çš„ <code>Probe</code> è®¾è®¡æ–¹æ¡ˆ</a>ï¼Œè€ƒè™‘åˆ° <code>LeakCanary</code> ç”¨äº†æ–°çš„<code>shark</code>è§£æ<code>hprof</code> æ–‡ä»¶ï¼Œå¯ä»¥åœ¨ç¾å›¢çš„æ–¹æ¡ˆä¸Šè¿›è¡Œå‡çº§</p>
</li>
</ol>
<h3 id="æ–‡ç« å‚è€ƒ">æ–‡ç« å‚è€ƒ</h3>
<p><a href="https://www.jianshu.com/p/e574f0ffdb42">ä¸å¯æ€è®®çš„OOM</a></p>
<p><a href="https://tech.meituan.com/2019/11/14/crash-oom-probe-practice.html">Probeï¼šAndroidçº¿ä¸ŠOOMé—®é¢˜å®šä½ç»„ä»¶</a></p>
<p><a href="https://cloud.tencent.com/developer/article/1071770">Android åˆ›å»ºçº¿ç¨‹æºç ä¸OOMåˆ†æ</a></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å†…å­˜æ³„éœ²åˆ†æå®šä½]]></title>
        <id>https://flyer88.github.io/post/nei-cun-xie-lu-fen-xi-ding-wei/</id>
        <link href="https://flyer88.github.io/post/nei-cun-xie-lu-fen-xi-ding-wei/">
        </link>
        <updated>2020-06-15T15:43:54.000Z</updated>
        <content type="html"><![CDATA[<ul>
<li><strong>å†…å­˜æ³„éœ²æ ¹æœ¬åŸå› </strong></li>
<li><strong>å†…å­˜æ³„éœ²å¸¸è§æƒ…å†µ</strong></li>
<li><strong>å†…å­˜æ³„éœ²å®šä½æ–¹æ¡ˆ</strong></li>
<li><strong>æœ€è¿‘ç¢°åˆ°çš„ç¤ºä¾‹</strong></li>
<li><strong>å¸¸è§å†…å­˜æ³„éœ²è§£å†³æ–¹æ¡ˆ</strong></li>
</ul>
<blockquote>
<p>è¯¥ç« èŠ‚éœ€é…åˆ <code>Java GC</code> æœºåˆ¶ ä¸€èµ·çœ‹</p>
</blockquote>
<h3 id="0x0001-å†…å­˜æ³„éœ²æ ¹æœ¬åŸå› ">0x0001. å†…å­˜æ³„éœ²æ ¹æœ¬åŸå› </h3>
<ol>
<li>
<p><strong><code>GCRoot</code> å¯¹è±¡é•¿æœŸæŒæœ‰å…¶ä»–å·²ç»æ— ç”¨çš„å¯¹è±¡ï¼ˆæœ¬è¯¥è¢«å›æ”¶ï¼Œå´æœªè¢«å›æ”¶ï¼‰</strong>ã€‚é€šä¿—çš„è¯´å°±æ˜¯ <strong>ç”Ÿå‘½å‘¨æœŸè¾ƒé•¿çš„å¯¹è±¡ï¼ˆå¦‚ static ç±»ï¼‰æŒæœ‰ç”Ÿå‘½å‘¨æœŸè¾ƒçŸ­çš„å¯¹è±¡çš„å¼•ç”¨ï¼ˆæŸä¸ª Activityï¼‰</strong></p>
</li>
<li>
<p><code>GCRoot</code> å¯¹è±¡åŒ…æ‹¬</p>
<ol>
<li>
<p>æ–¹æ³•åŒºé™æ€å±æ€§ ï¼Œå¸¸é‡ï¼ˆå¤šæ•°ä¼´éšæ•´ä¸ªè™šæ‹Ÿæœºçš„ç”Ÿå‘½å‘¨æœŸï¼‰</p>
</li>
<li>
<p>æ ˆå¸§ä¸­æœ¬åœ°å˜é‡è¡¨ä¸­çš„å¼•ç”¨å¯¹è±¡ ï¼ˆå³å½“å‰çº¿ç¨‹æ­£åœ¨è¿è¡Œçš„ä»£ç æŒæœ‰çš„å¯¹è±¡ï¼‰</p>
</li>
<li>
<p>JNI æœ¬åœ°æ–¹æ³•å¼•ç”¨çš„å¯¹è±¡ ï¼ˆnative åŒºå¼•ç”¨çš„å¯¹è±¡ï¼‰</p>
</li>
</ol>
</li>
</ol>
<h3 id="0x0002-å†…å­˜æ³„éœ²å¸¸è§æƒ…å†µ">0x0002. å†…å­˜æ³„éœ²å¸¸è§æƒ…å†µ</h3>
<ol>
<li>
<p>é™æ€å¯¹è±¡</p>
<ul>
<li>
<p><code>static activity</code></p>
</li>
<li>
<p><code>static view</code></p>
</li>
</ul>
</li>
<li>
<p><code>activity/fragment</code> é”€æ¯ï¼Œç»“æŸè€—æ—¶ä»»åŠ¡(å¼‚æ­¥ç½‘ç»œè¯·æ±‚)</p>
</li>
<li>
<p><code>inner class</code> å­˜åœ¨å¼‚æ­¥ç­‰æƒ…å†µ</p>
</li>
<li>
<p><code>SingleInstance</code> æŒæœ‰å±€éƒ¨ç”Ÿå‘½å‘¨æœŸ <code>Activity</code></p>
</li>
<li>
<p>èµ„æºç±» <code>cursor</code> æ²¡æœ‰å…³é—­</p>
</li>
</ol>
<blockquote>
<p>è¡¥å……ï¼Œ<code>lamda</code> è¡¨è¾¾å¼æ˜¯åŒ¿åå†…éƒ¨ç±»</p>
</blockquote>
<h3 id="0x0003-å†…å­˜æ³„éœ²å®šä½æ–¹æ¡ˆ">0x0003. å†…å­˜æ³„éœ²å®šä½æ–¹æ¡ˆ</h3>
<ol>
<li>
<p>é™æ€åˆ†æ</p>
<p>è·‘ <code>Lint</code>ï¼Œæ³¨æ„çœ‹ <code>Warning</code> ï¼Œä¼šé’ˆå¯¹ <code>handler</code> ç­‰ï¼Œè¿›è¡Œæç¤º</p>
</li>
<li>
<p>åŠ¨æ€åˆ†æ</p>
<ul>
<li><code>leakCanary</code></li>
<li><code>adb shell dumpsys meminfo [PackageName]</code></li>
<li><code>Android Profiler</code> (è§ä¸‹æ–¹å†…å­˜æ³„éœ²å®ä¾‹è¯¦è§£)</li>
</ul>
<p>ä»¥ä¸Šä¸‰è€…ï¼Œæ ¹æ®ä¸ªäººç»éªŒå¯ä»¥ç»“åˆèµ·æ¥ä½¿ç”¨</p>
<ol>
<li><code>leakCanary</code> å¯ä»¥ç”¨äºå¿«é€Ÿå®šä½å†…å­˜æ³„éœ²é—®é¢˜</li>
<li>å½“é¢å¯¹ <code>leakCanary</code> æ— æ³•ç›´æ¥ç¡®å®šå†…å­˜æ³„éœ²çš„æ—¶ï¼Œå¯ä»¥ç”¨ <code>adb shell dumpsys</code> è¿›è¡Œè¾…åŠ©ç¡®è®¤æ³„éœ² <code>activity</code></li>
<li>æ ¹æ®å‰ä¸¤è€…ç¡®å®šçš„ <code>activity</code> é…åˆ <code>Android Profiler</code> <code>GC</code> åè¿›è¡Œåˆ†æï¼ŒæŸ¥çœ‹æ²¡æœ‰å›æ”¶çš„å¯¹è±¡çš„å¼•ç”¨é“¾ï¼Œå³å¯å®šä½å†…å­˜æ³„æ¼ä½ç½®</li>
</ol>
</li>
</ol>
<h3 id="0x0004-æœ€è¿‘ç¢°åˆ°çš„ç¤ºä¾‹">0x0004.  æœ€è¿‘ç¢°åˆ°çš„ç¤ºä¾‹</h3>
<p>â€‹	èƒŒæ™¯ä»‹ç»ï¼š ä¸€ä¸ªå•†å“è¯¦æƒ…é¡µï¼Œæœ‰å†…å­˜æ³„éœ² ã€‚</p>
<ol>
<li>
<p><code>LeakCanary</code>  æŠ¥é”™æˆªå›¾ï¼Œå‘ç°æ˜¯ä¸€ä¸ª <code>UI</code> æ¶ˆæ¯é˜Ÿåˆ—ä¸Šçš„ä¸€æ¡æ¶ˆæ¯æ³„éœ²äº†ï¼Œæ— æ³•ç›´æ¥å®šä½å…·ä½“ä»£ç ã€‚<br>
<img src="https://flyer88.github.io/post-images/1592235944966.png" alt="img" loading="lazy"></p>
</li>
<li>
<p>æ­¤æ—¶ï¼Œåˆ©ç”¨ <code>adb shell dumpsys meminfo</code>ï¼Œç„¶åå¤šæ¬¡è¿›å‡º <code>SpuDetailActivity</code> ï¼ŒéªŒè¯ç¡®è®¤æ˜¯ <code>SpuDetailActivity</code> å­˜åœ¨æ³„éœ²ã€‚</p>
</li>
</ol>
<pre><code class="language-shell">âœ adb shell dumpsys meminfo com.leixun.taofen8.haoda
Applications Memory Usage (in Kilobytes):
Uptime: 693212294 Realtime: 787382396

** MEMINFO in pid 14754 [com.leixun.taofen8.haoda] **
                   Pss  Private  Private  SwapPss     Heap     Heap     Heap
                 Total    Dirty    Clean    Dirty     Size    Alloc     Free
                ------   ------   ------   ------   ------   ------   ------
  Native Heap    74230    74108        0      230    98688    86999    11688
  Dalvik Heap     6442     5952        0       25    11519     5760     5759
 Dalvik Other     2683     2680        0        4
        Stack       84       84        0        0
       Ashmem        2        0        0        0
      Gfx dev    28316    28316        0        0
    Other dev       28        0       28        0
     .so mmap    15415      280     7720        7
    .jar mmap     3762        0     1844        0
    .apk mmap      432        0      132        0
    .ttf mmap      107        0       48        0
    .dex mmap    19419    19344       32        0
    .oat mmap      621        0        4        0
    .art mmap     4696     4108        0        9
   Other mmap     5421      476     3348        0
      Unknown     2842     2808        0        6
        TOTAL   164781   138156    13156      281   110207    92759    17447

 App Summary
                       Pss(KB)
                        ------
           Java Heap:    10060
         Native Heap:    74108
                Code:    29404
               Stack:       84
            Graphics:    28316
       Private Other:     9340
              System:    13469

               TOTAL:   164781       TOTAL SWAP PSS:      281

 Objects
               Views:      341         ViewRootImpl:        2
         AppContexts:        7           Activities:        2
              Assets:       18        AssetManagers:        0
       Local Binders:       25        Proxy Binders:       37
       Parcel memory:       11         Parcel count:       48
    Death Recipients:        2      OpenSSL Sockets:       13
            WebViews:        0

 SQL
         MEMORY_USED:        0
  PAGECACHE_OVERFLOW:        0          MALLOC_SIZE:        0
 
 Asset Allocations
      : 162K
</code></pre>
<ol start="3">
<li>
<p>ç”±äºä¸ªäººç»éªŒä¸°å¯Œï¼Œç›´æ¥å€ŸåŠ© <code>LeakCanary</code> å’Œ <code>adb shell dumpsys meminfo</code> é…åˆå‡ æ¬¡è¯•é”™ï¼Œå®šä½åˆ°é—®é¢˜</p>
<blockquote>
<p>æ•´ä¸ªæ¨å¯¼æµç¨‹ï¼š</p>
<p><code>UI</code> -&gt; <code>Handler</code> -&gt; <code>MutableLiveData</code> -&gt; <code>MutableLiveData.observe()</code></p>
<p><code>UI</code> æ¶ˆæ¯å‘é€ï¼Œè‡ªå·±ä»£ç ä¸­æ²¡æœ‰ <code>handler</code> ä¹‹ç±»çš„ï¼Œç”¨äº†åªæœ‰ <code>MutableLiveData</code> æ¥æ›´æ–° <code>View</code>ï¼Œå¿«é€Ÿå®šä½ä¸¤ä¸ª <code>LiveData Observe</code> çš„ä»£ç ï¼Œé…åˆ <code>adb shell dumpsys meminfo</code> ç›´æ¥éªŒè¯æ³¨é‡Šæ‰å‡ ä¸ªæ–¹æ³•ï¼Œçœ‹ <code>Activity</code> æ•°é‡ï¼Œå¿«é€Ÿå®šä½å‡ºé—®é¢˜å‡ºåœ¨ <code>spuDetailBinding.hdPtrList.refreshComplete()</code>ï¼Œ è¯¥ç¬¬ä¸‰æ–¹åº“è°ƒç”¨é”™è¯¯æ—¶ä¼šå‡ºç°å†…å­˜æ³„éœ²ã€‚</p>
</blockquote>
<pre><code class="language-java">...       
  viewModel.loadSuccess.observe(this, aBoolean -&gt; {
      	if (aBoolean) {
      		adapter.submitList(viewModel.itemViewModels);
      	}
      	hideProgressDialog();
      	spuDetailBinding.hdPtrList.refreshComplete();
   });
   viewModel.loadRelatedSuccess.observe(this, aBoolean -&gt; {
       adapter.submitList(viewModel.itemViewModels);
   });
 ...
</code></pre>
</li>
<li>
<p><code>Android Profiler</code> å†…å­˜è¿›è¡Œä¸¾ä¾‹æ€§åˆ†æï¼Œå®šä½é—®é¢˜æ‰€åœ¨</p>
</li>
</ol>
<blockquote>
<p>ä½¿ç”¨ <code>profiler</code> çš„æ—¶å€™ï¼Œæœ€å¥½æŠŠ <code>leakCanary</code> å»æ‰ï¼Œå½±å“æ‰‹åŠ¨ <code>GC</code>ï¼Œè€Œä¸”è¿˜ä¼šå¼•èµ·å¡é¡¿</p>
<p>ä¸ç†Ÿç»ƒ <code>profiler</code>ï¼Œå¯ä»¥é…åˆ <a href="https://developer.android.com/studio/profile/memory-profiler">Android Profiler å®˜æ–¹ä½¿ç”¨æŒ‡å—</a>é£Ÿç”¨</p>
</blockquote>
<ol>
<li>
<p><strong>è¿æ¥ <code>profiler</code></strong><br>
<img src="https://flyer88.github.io/post-images/1592235971126.png" alt="ğŸ˜€" loading="lazy"><br>
â€‹</p>
</li>
<li>
<p><strong>æ‰‹åŠ¨è§¦å‘<code>GC</code></strong><br>
<img src="https://flyer88.github.io/post-images/1592235992860.png" alt="ğŸ˜" loading="lazy"></p>
</li>
<li>
<p><strong>é€‰ä¸­å†…å­˜åŒºåŸŸï¼Œæ‰¾åˆ°æ³„éœ²çš„ <code>Activity</code></strong><br>
<img src="https://flyer88.github.io/post-images/1592236015842.png" alt="ğŸ˜‚" loading="lazy"></p>
</li>
<li>
<p>æ ¹æ®ä¹‹å‰ <code>LeakCanary</code> æŠ¥é”™ï¼Œç›´æ¥å®šä½ <code>MessageQueue</code> æŒæœ‰çš„å¯¹è±¡<br>
<img src="https://flyer88.github.io/post-images/1592236028325.png" alt="ğŸ¤£" loading="lazy"></p>
</li>
</ol>
<h3 id="0x0005-å¸¸è§å†…å­˜æ³„éœ²è§£å†³æ–¹æ¡ˆ">0x0005. å¸¸è§å†…å­˜æ³„éœ²è§£å†³æ–¹æ¡ˆ</h3>
<ol>
<li><code>WeakReference</code> è¿›è¡ŒåŒ…è£¹</li>
<li>ç”¨è°·æ­Œå®˜æ–¹æä¾›çš„ç”Ÿå‘½å‘¨æœŸç»„ä»¶ï¼Œç±»ä¼¼ <code>MutableLiveData</code> ä¹‹ç±»çš„</li>
</ol>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ã€æ—§ã€‘å¦‚ä½•å®ç° RxJava çš„é“¾å¼è°ƒç”¨ -- flatmap æ–¹æ³•çš„å®ç°]]></title>
        <id>https://flyer88.github.io/post/jiu-ru-he-shi-xian-rxjava-de-lian-shi-diao-yong-flatmap-fang-fa-de-shi-xian/</id>
        <link href="https://flyer88.github.io/post/jiu-ru-he-shi-xian-rxjava-de-lian-shi-diao-yong-flatmap-fang-fa-de-shi-xian/">
        </link>
        <updated>2020-06-15T10:39:16.000Z</updated>
        <content type="html"><![CDATA[<blockquote>
<p>å†™äº 2017å¹´ 05 æœˆ 24 æ—¥</p>
</blockquote>
<pre><code class="language-java">public interface Api{
    void queryPhoto(String query,QueryCallback QueryCallback);
    void store(Photo photo,StoreCallback storeCallback);
    interface QueryCallback{
        void onQuerySuccess(List&lt;Photo&gt; photoList);
        void onQueryFailed(Exception e);
    }
    interface StoreCallback{
        void onCatStored(Uri uri);
        void onStoredFailed(Exception e);
    }
}
</code></pre>
<pre><code class="language-java">RxJob&lt;List&lt;Photo&gt;&gt; queryPhotoJob = new RxJob&lt;List&lt;Photo&gt;&gt;(){
  				@Override
                public void doJob(final RxCallback&lt;List&lt;Photo&gt;&gt; rxCallback) {
                    mApi.queryPhoto(&quot;flyer&quot;, new Api.QueryCallback() {
                        @Override
                        public void onQuerySuccess(List&lt;Photo&gt; photoList) {
                            rxCallback.onNext(photoList);
                        }
                      

                        @Override
                        public void onQueryFailed(Exception e) {
                            rxCallback.onError(e);
                        }
                    });
                }
            };
};

RxJob&lt;List&lt;Photo&gt;&gt; storePhotoJob = new RxJob&lt;Uri&gt;() {
            @Override
            public void doJob(RxCallback&lt;Uri&gt; rxCallback) {
                mApi.store(photo, new Api.StoreCallback() {
                    @Override
                    public void onCatStored(Uri uri) {
                        rxCallback.onNext(uri);
                    }

                    @Override
                    public void onStoredFailed(Exception e) {
			rxCallback.onError(e);
                    }
                });
            }
        };


queryPhotoJob.map(photoList -&gt; { return getBestPhoto(photoList);})
  	.flatMap(photo -&gt; { return storePhotoJob;} )
	.map(photo -&gt; {return photo.getUrl();})
	.doJob(new RxCallback&lt;String&gt;() {
            @Override
            public void onNext(String s) {
		ToastUtils.show(s);
            }

            @Override
            public void onError(Exception e) {
		ToastUtils.show(e);
            }
   });
</code></pre>
<pre><code class="language-java">public abstract class RxJob&lt;T&gt;{
	public abstract void doJob(RxCallback&lt;T&gt; rxCallback){}
  	public RxJob map(){
        final RxJob&lt;T&gt; curJob = this;
        return new RxJob&lt;R&gt;() {
            @Override
            public void doJob(final RxCallback&lt;R&gt; rxCallback) {
                curJob.doJob(new RxCallback&lt;T&gt;() {
                    @Override
                    public void onNext(T t) {
                        R mapped = func.call(t);
                        rxCallback.onNext(mapped);
                    }

                    @Override
                    public void onError(Exception e) {
                        rxCallback.onError(e);
                    }
                });
            }
        };
    }
  	public RxJob flatMap(){...};
}
</code></pre>
<h3 id="flatmap-çš„å®ç°"><code>flatMap</code> çš„å®ç°</h3>
<p>å‰ä¸€ç¯‡æ–‡ç« ä»‹ç»äº†é“¾å¼è°ƒç”¨çš„å½¢æˆä»¥åŠ <code>map</code> æ–¹æ³•çš„å®ç°ï¼Œ<code>map</code> æ–¹æ³•å®ç°çš„æ˜¯ T -&gt; R çš„ç±»å‹è½¬æ¢</p>
<blockquote>
<p><a href="https://gist.github.com/flyer88/5d7129fc2ca9010ff6109a81157fbafa">å¦‚ä½•å®ç° RxJava çš„é“¾å¼è°ƒç”¨ -- map æ–¹æ³•çš„å®ç°</a></p>
</blockquote>
<p>ä½†å¦‚æœ <code>map</code> æ–¹æ³•ä¸­éœ€è¦å®ç° ä¸€ä¸ªå¼‚æ­¥æ–¹æ³•å‘¢ï¼Ÿ</p>
<pre><code class="language-java">queryPhotoJob.map(photoList -&gt; { return getBestPhoto(photoList);})
		.map(photo -&gt; {mApi.store(photo)} )
  		.map(uri -&gt; {loadImage(uri)})
</code></pre>
<p>æ³¨æ„ <code>mApi.store(photo)</code> æ˜¯å¼‚æ­¥ä»»åŠ¡ï¼Œæ— æ³•ç›´æ¥è¿”è¿˜ä¸€ä¸ª<code>uri</code> ç±»å‹ã€‚</p>
<p>äºæ˜¯éœ€è¦ç”¨åˆ° <code>flatMap</code> æ–¹æ³•ã€‚</p>
<p><code>flatMap</code> åŒæ ·éœ€è¦ç”¨åˆ° <code>R call(T t)</code> è¿™ä¸ªè½¬å˜å‡½æ•°</p>
<blockquote>
<p><strong>é¦–å…ˆå›å¤´è€ƒè™‘ï¼Œæˆ‘ä»¬æœ€å¼€å§‹çš„ç¬¬ä¸€ä¸ªå¼‚æ­¥æ–¹æ³•æ˜¯å¦‚ä½•å®ç°çš„ï¼Œä¹Ÿå°±æ˜¯ <code>queryPhotoJob</code> çš„åˆ›å»º</strong></p>
<p><strong>æ‰§è¡Œæ˜¯åœ¨ <code>doJob()</code> æ–¹æ³•ä¸­æ‰§è¡Œäº† <code>mApi.queryPhoto()</code> ç„¶åè°ƒç”¨ <code>rxCallback.onNext()</code> ç»§ç»­å¾€ä¸‹èµ°</strong></p>
</blockquote>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-java">RxJob&lt;List&lt;Photo&gt;&gt; queryPhotoJob = new RxJob&lt;List&lt;Photo&gt;&gt;(){
  				@Override
                public void doJob(final RxCallback&lt;List&lt;Photo&gt;&gt; rxCallback) {
                    mApi.queryPhoto(&quot;flyer&quot;, new Api.QueryCallback() {
                        @Override
                        public void onQuerySuccess(List&lt;Photo&gt; photoList) {
                            rxCallback.onNext(photoList);
                        }
                      

                        @Override
                        public void onQueryFailed(Exception e) {
                            rxCallback.onError(e);
                        }
                    });
                }
            };
};
</code></pre>
<p>ç”±æ­¤è€ƒè™‘ï¼Œ<code>flatMap</code> æ–¹æ³•ä¸­ä¹Ÿå¯ä»¥æŠŠé‚£ä¸ªå¼‚æ­¥æ–¹æ³•å¤„ç†æˆä¸€ä¸ª <code>RxJob</code> å¯¹è±¡</p>
<p>ç„¶åè®©ä»–æŠŠå›è°ƒå¾€è¿”è¿˜çš„ <code>new RxJob()</code> ä¸­çš„ <code>doJob</code> æ–¹æ³•ä¸­ çš„ <code>Callback</code> å¾€ä¸‹ä¸€ä¸ª <code>RxJob</code> ä¼ é€’</p>
<pre><code class="language-java">public &lt;R&gt; RxJob&lt;R&gt; flatMap(final Func&lt;T,RxJob&lt;R&gt;&gt; func){
    final RxJob&lt;T&gt; curJob = this;
    return new RxJob&lt;R&gt;() {
        @Override
        public void doJob(final RxCallback&lt;R&gt; rxCallback) {
            curJob.doJob(new RxCallback&lt;T&gt;() {
                @Override
                public void onNext(T t) {
                    // æ­¤å¤„æ˜¯æœ€å¤§çš„åŒºåˆ«,å¤–éƒ¨å‡½æ•°çš„è½¬æ¢
                    RxJob&lt;R&gt; flatMapped = func.call(t);
                  	// å¾—åˆ° flatMapped ï¼Œç„¶åè°ƒç”¨
                    flatMapped.doJob(new RxCallback&lt;R&gt;() {
                        @Override
                        public void onNext(R r) {
                            // æŠŠéœ€è¦å˜æ¢å‡ºçš„ç±»å‹å¾€ä¸‹ä¸€ä¸ªä»»åŠ¡ä¼ é€’
                          	// æ­¤å¤„å’Œ map æ–¹æ³•å¤„ç†ä¸€è‡´
                            rxCallback.onNext(r);
                        }

                        @Override
                        public void onError(Exception e) {
                            rxCallback.onError(e);
                        }
                    });
                }

                @Override
                public void onError(Exception e) {
                    rxCallback.onError(e);
                }
            });
        }
    };
}
</code></pre>
<h3 id="map-å’Œ-flatmap-çš„å¯¹æ¯”"><code>map</code> å’Œ <code>flatMap</code> çš„å¯¹æ¯”</h3>
<p><code>flatMap</code> å’Œ <code>map</code> æœ€å¤§çš„åŒºåˆ«å°±æ˜¯è¿”è¿˜çš„ <code>RxJob</code> å¯¹è±¡ä¸­ <code>curJob.doJob</code> ä¸­å›è°ƒçš„åŒºåˆ«</p>
<p><code>flatMap</code> æ–¹æ³•æ ¸å¿ƒéƒ¨åˆ†</p>
<pre><code class="language-java"> // æ­¤å¤„æ˜¯æœ€å¤§çš„åŒºåˆ«
 RxJob&lt;R&gt; flatMapped = func.call(t);
 flatMapped.doJob(new RxCallback&lt;R&gt;() {
   @Override
   public void onNext(R r) {
   	rxCallback.onNext(r);
   }

  @Override
  public void onError(Exception e) {
       rxCallback.onError(e);
  }
});
</code></pre>
<p><code>map</code> æ–¹æ³•æ ¸å¿ƒéƒ¨åˆ†</p>
<pre><code class="language-java">R mapped = func.call(t);
rxCallback.onNext(mapped);
</code></pre>
<p><code>flatMap</code> åœ¨å›è°ƒå®Œä»¥åï¼Œè¿è¡Œçš„æ˜¯ <code>flatMapped.doJob()</code></p>
<p>å¹¶ä¸”æŠŠå½“å‰ <code>RxJob</code> å¯¹è±¡ <code>rxCallback</code> çš„å›è°ƒæ”¾åˆ°äº†<code>flatMapped.doJob</code> ä¸­çš„å›è°ƒç”¨</p>
<p>ä»è€Œä½¿å¾—ä¸‹ä¸€ä¸ªæ•°æ® <code>r</code> æ˜¯åœ¨è¿è¡Œå®Œ <code>flatMapped</code> ä»»åŠ¡åç”Ÿæˆçš„ã€‚</p>
<p>ä»£å…¥æ­¤å¤„å°±æ˜¯ <code>r</code> å°±æ˜¯ <code>mApi.store(photo,callback)</code> ä¸­çš„ <code>photo</code></p>
<h3 id="è§£é‡Šä¸ºä»€ä¹ˆ-map-å‡½æ•°æ— æ³•å®ç°-flatmap-çš„åŠŸèƒ½">è§£é‡Šä¸ºä»€ä¹ˆ <code>map</code> å‡½æ•°æ— æ³•å®ç° <code>flatMap</code> çš„åŠŸèƒ½ï¼Ÿ</h3>
<p><code>flatMap</code> ä¸­çš„è½¬å˜å‡½æ•°çš„å…·ä½“å®ç°æ˜¯ <code>T -&gt; RxJob&lt;R&gt;</code> çš„è½¬æ¢</p>
<p>å¸¦å…¥å½“å‰ä¾‹å­å°±æ˜¯ <code>Photo â€”&gt; RxJob&lt;String&gt;</code></p>
<p>æ³¨æ„ï¼Œä¹‹å‰çš„ <code>map</code> æ–¹æ³•æ˜¯ <code>List â€”&gt; Photo</code>  è€Œä¸æ˜¯ <code>List&lt;Photo&gt; -&gt; Photo</code></p>
<p>å› ä¸º <code>map</code> æ–¹æ³•çš„å…¥å‚æ˜¯ <code>Func&lt;T,R&gt; func</code> ï¼Œè€Œä¸æ˜¯ <code>Func&lt;List&lt;T&gt;,R&gt; func</code></p>
<p>è€Œ <code>flaMap</code> å‡½æ•°çš„å…¥å‚åˆ™æ˜¯ <code>Func&lt;T,RxJob&lt;R&gt;&gt; func</code>,å†™æ­»äº†ç¬¬äºŒä¸ªå‚æ•°ç±»å‹å¿…é¡»æ˜¯ <code>RxJob&lt;R&gt;</code> ï¼Œç„¶å <code>RxJob&lt;R&gt;</code> æ–¹æ³•ä¼šè¢«æ‰§è¡Œ</p>
<p>åšåˆ°äº†å¼‚æ­¥ä¸­çš„å¼‚æ­¥ï¼ŒåŒæ ·ä¹Ÿè¯´æ˜äº†å…¥å‚ <code>Func&lt;?,?&gt; func</code> ä¼šå†³å®šè½¬æ¢å‡½æ•°çš„åŠŸèƒ½ï¼Œä»è€Œå½±å“æ•´ä¸ªå˜æ¢çš„ä¸åŒ</p>
<p><code>map</code> å’Œ <code>flatMap</code> çš„åŒºåˆ«å°±å¦‚ä¸‹å›¾</p>
<pre><code>					map
	  A ------------&gt;  B/[B]		
    
												
					flatMap							
	 [A]------------&gt; [B]									 

</code></pre>
<p>â€‹</p>
<p>å…¶æ ¸å¿ƒåœ¨äºç±»å‹çš„å˜æ¢ï¼Œå³ <code>Func&lt;?,?&gt; func</code>ä¹Ÿå°±æ˜¯å‡½æ•°å¼ç¼–ç¨‹ä¸­çš„ <code>Functor</code></p>
<p>ä¸åŒçš„ <code>func</code> å°±ä¼šå®ç°ä¸åŒçš„å˜æ¢ï¼Œ <code>flatMap</code> å°±æ˜¯ä¸€ä¸ª <code>Monad</code></p>
<p>å½“å…¶è¿ç”¨åˆ° <a href="https://github.com/ReactiveX">ReactiveX</a> ä¸Šæ—¶ï¼Œå…¶è½¬æ¢æ ¸å¿ƒå°±æ˜¯æ•°æ®æµï¼Œä¹Ÿå°±åšåˆ°äº† <code>Observe/Subscribe</code> çš„æ¨¡å¼ï¼Œå› ä¸ºåœ¨æ¯ä¸€æ¬¡å˜æ¢åæ•°æ®å§‹ç»ˆå­˜åœ¨ï¼Œå¯¹åº”çš„æ“ä½œä¹Ÿå¯è§¦å‘ã€‚ä¸è¿‡ <code>RxJava</code> è¿˜æœ‰æ›´å¤šå…¶ä»–çš„ä¸œè¥¿ï¼Œä¸ä»…ä»…æ˜¯è¿™ä¸¤ä¸ªå˜æ¢ã€‚ä½†åŸºæœ¬ä¸Šç†è§£è¿™ä¸¤ä¸ªå˜æ¢å°±èƒ½ä¸¾ä¸€åä¸‰äº†ï¼Œç†è§£å…¶ä»–å˜æ¢</p>
<p><code>RxJava</code> ä¸­çš„ <code>map/flatMap</code> ä¹Ÿæ˜¯åˆ›å»ºå¯¹äºçš„ <code>Observable</code> å¯¹è±¡ï¼Œç„¶åè°ƒç”¨å¯¹åº”çš„å‡½æ•°ï¼Œç„¶åè¿”å›éœ€è¦çš„æ•°æ®</p>
<p>å…¶ä¸­ <code>map</code> æ–¹æ³•ä¸­çš„å…¥å‚ <code>Function</code>ï¼Œåªä¼šåœ¨å„ç§ç±»å‹ä¸­è½¬æ¢</p>
<p>è€Œ <code>flatMap</code> ä¸­çš„å…¥å‚ <code>Function</code> å¿…ç„¶ä¼šè½¬æ¢å‡ºä¸€ä¸ª <code>Observable&lt;R&gt;</code> ç±»å‹</p>
<p>åœ¨ <code>RxJava 2</code> è½¬æ¢å‡ºçš„æ˜¯ä¸€ä¸ª <code>ObservableSource&lt;R&gt;</code></p>
<p>å®˜æ–¹è§£é‡Šå¦‚ä¸‹ï¼Œnon-backpressured Observableï¼Œå¯ä»¥ç†è§£ä¸ºç±»ä¼¼ <code>Observable</code> ç±»å‹ï¼Œæ­¤å¤„å’Œ <code>backpressured</code> çš„ä¸€äº›æ¦‚å¿µæœ‰å…³è”ï¼Œä¸ä½œè§£é‡Šã€‚</p>
<blockquote>
<p>Represents a basic, non-backpressured {@link Observable} source base interface</p>
</blockquote>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ã€æ—§ã€‘å¦‚ä½•å®ç° RxJava çš„é“¾å¼è°ƒç”¨ -- map æ–¹æ³•çš„å®ç°]]></title>
        <id>https://flyer88.github.io/post/jiu-ru-he-shi-xian-rxjava-de-lian-shi-diao-yong-map-fang-fa-de-shi-xian-md/</id>
        <link href="https://flyer88.github.io/post/jiu-ru-he-shi-xian-rxjava-de-lian-shi-diao-yong-map-fang-fa-de-shi-xian-md/">
        </link>
        <updated>2020-06-15T10:32:01.000Z</updated>
        <content type="html"><![CDATA[<blockquote>
<p>å†™äº 2017å¹´ 05 æœˆ 24 æ—¥</p>
</blockquote>
<pre><code class="language-java">public interface Api{
    void queryPhoto(String query,QueryCallback QueryCallback);
    interface QueryCallback{
        void onQuerySuccess(List&lt;Photo&gt; photoList);
        void onQueryFailed(Exception e);
    }
}
</code></pre>
<pre><code class="language-java">public class PhotoUtils{
    Api mApi;
    public void handlePhotoSync(){
        mApi.queryPhoto(&quot;flyer&quot;, new Api.QueryCallback() {
            @Override
            public void onQuerySuccess(List&lt;Photo&gt; photoList) {
                Photo photo = getBestPhoto(photoList);
              	String imgUrl = photo.getUrl();
            }

            @Override
            public void onQueryFailed(Exception e) {
				ToastUtils.show(e);
            }
        });
    }
}
</code></pre>
<p><strong>æ­¤æ—¶å‡è®¾æœ‰ä¸€ä¸ªåŒ…è£¹ç±»ï¼Œä»–å¯ä»¥è¿è¡Œ <code>getBestPhoto(photoList)</code> å’Œ <code>photo.getUrl()</code> è¿™ä¸¤è¡Œä»£ç ï¼Œè€Œè¿™ä¸¤è¡Œä»£ç ç”±å¤–éƒ¨æ”¾å…¥</strong></p>
<p>é‚£ä¹ˆè°ƒç”¨å°±ä¼šå¦‚ä¸‹ï¼š</p>
<pre><code class="language-java">RxJob&lt;List&lt;Photo&gt;&gt; queryPhotoJob = new RxJob&lt;List&lt;Photo&gt;&gt;(){
  				@Override
                public void doJob(final RxCallback&lt;List&lt;Photo&gt;&gt; rxCallback) {
                    mApi.queryPhoto(&quot;flyer&quot;, new Api.QueryCallback() {
                        @Override
                        public void onQuerySuccess(List&lt;Photo&gt; photoList) {
                            rxCallback.onNext(photoList);
                        }
                      

                        @Override
                        public void onQueryFailed(Exception e) {
                            rxCallback.onError(e);
                        }
                    });
                }
            };
};
  // å¦‚æœæœ‰è¿™ä¹ˆä¸€ä¸ªåŒ…è£¹ç±»ï¼Œä»£ç å°±å¯ä»¥å†™æˆä¸‹é¢è¿™æ ·ï¼Œåˆ™å½“éœ€è¦è°ƒç”¨çš„æ—¶å€™ï¼Œ
  // ä»£ç å°±ä¼šå’Œ RxJava å¾ˆç±»ä¼¼( java 8 ä¸Šä¼šå˜æˆ Lambda è¡¨è¾¾å¼ )
  // ä»è€Œä½¿å¾—ä»£ç å…·æœ‰å¾ˆæ¸…æ™°çš„é€»è¾‘ï¼Œå¼‚æ­¥ä»£ç çœ‹ä¸Šå»ä¹Ÿä¼šå˜çš„å¦‚åŒæ­¥ä»£ç ä¸€æ ·ã€‚
queryPhotoJob
  .map(photoList -&gt; { return getBestPhoto(photoList);})
  //.map(new Func&lt;List&lt;Photo&gt;,Photo&gt;()
  //          @Overide
  //          Photo call(List&lt;Photo&gt; photoList){
  //		    return getBestPhoto(photoList);
  //		  })
  .map(photo -&gt; {return photo.getUrl()})
  .doJob(new RxCallback&lt;T&gt;() {
            @Override
            public void onNext(T t) {

            }

            @Override
            public void onError(Exception e) {

            }
   });
</code></pre>
<p>å› æ­¤æ¥ä¸‹æ¥éœ€è¦è€ƒè™‘å¦‚ä½•å®ç°è¿™ä¸ªåŒ…è£¹çš„ç±»ï¼Œä½¿å¾—å…¶è°ƒç”¨ä¼šåƒ  <code>RxJava</code> ä¸€èˆ¬ã€‚é¦–å…ˆéœ€è¦ç¡®å®šè¯¥ç±»éœ€è¦å¤„ç†ä»¥ä¸‹å‡ ä¸ªé—®é¢˜</p>
<ul>
<li>è¯¥åŒ…è£¹çš„ç±»æœ‰å“ªäº›æ–¹æ³•åŠå…¶ä½¿ç”¨</li>
<li><code>map</code> å‡½æ•°å¦‚ä½•å®ç°ï¼Œå…¶è°ƒç”¨é€»è¾‘</li>
</ul>
<h3 id="æ•´ä½“ä»‹ç»">æ•´ä½“ä»‹ç»ï¼š</h3>
<p>ç¡®å®šä¸€ä¸ªåŒ…è£¹ç±» â€”&gt; åˆ›å»ºåŒ…è£¹ç±» <code>new RxJob()</code> â€”&gt; <code>map</code> æ–¹æ³•å®ç°</p>
<h3 id="map-æ–¹æ³•å®ç°åŒ…æ‹¬"><code>map</code> æ–¹æ³•å®ç°åŒ…æ‹¬ ï¼š</h3>
<p>å…¥å‚å’Œå‡ºå‚çš„åŸºæœ¬ç±»å‹ç¡®å®š â€”&gt; è½¬å˜å‡½æ•°çš„ç¡®å®š  â€”&gt; <code>doJob</code> è°ƒç”¨ â€”&gt; <code>map</code> è¿”è¿˜å€¼å…·ä½“ä»‹ç» â€”&gt; <code>func.call()</code> è¿”è¿˜å€¼çš„ä¼ é€’</p>
<h3 id="åŒ…è£¹ç±»æ–¹æ³•å’Œä½œç”¨">åŒ…è£¹ç±»æ–¹æ³•å’Œä½œç”¨</h3>
<p>é¦–å…ˆå–åï¼Œè¯¥ç±»å« <code>RxJob</code></p>
<p><code>RxJob</code> ç±»çš„æ„ä¹‰ï¼Œå®ƒè¢«å®šä¹‰æˆä¸€ä¸ªä»»åŠ¡ï¼Œç±»ä¼¼ <code>AsyncTask</code> ï¼Œè€Œè¿è¡Œè¯¥ä»»åŠ¡çš„æ–¹æ³•å°±æ˜¯ <code>doJob</code> æœ‰å…¥å‚ <code>RxCallback</code></p>
<p>ç±»çš„å®šä¹‰è¿˜æœ‰ä¸€ä¸ªæ³›å‹ <code>T</code> ï¼Œä¸»è¦å†³å®šäº† <code>doJob</code> æ–¹æ³•ä¸­ <code>RxCallback&lt;T&gt;</code> ä¸­çš„ <code>T</code> ç±»å‹</p>
<p>è¯¥ç±»å‹ä¼šå½±å“å¾ˆå¤šéƒ¨åˆ†çš„å‚æ•°ç±»å‹ï¼Œå…·ä½“éœ€è¦å‚è€ƒåé¢çš„åˆ†æã€‚</p>
<p>ä»£ç å¦‚ä¸‹:</p>
<pre><code class="language-java">public abstract class RxJob&lt;T&gt; {
    public abstract void doJob(RxCallback&lt;T&gt; rxCallback);
    public &lt;R&gt; RxJob&lt;T&gt; map(final Func&lt;T,R&gt; func){...}
}
</code></pre>
<p>å…ˆå¿½ç•¥ <code>map</code> æ–¹æ³•ï¼Œç°çœ‹ <code>doJob(RxCallback&lt;T&gt; rxCallback)</code></p>
<p><code>doJob(RxCallback&lt;T&gt; rxCallback)</code> æœ‰ä¸€ä¸ªå›è°ƒï¼Œå›è°ƒæ¥å£å®šä¹‰å¦‚ä¸‹ï¼š</p>
<pre><code class="language-java">public interface RxCallback&lt;T&gt; {
    void onNext(T t);
    void onError(Exception e);
}
</code></pre>
<p>ä¸¤ä¸ªæ–¹æ³•ï¼Œ<code>onNext(T t)</code> å’Œ <code>onError(Exception e)</code> ,ä¸€ä¸ªç”¨æ¥ä¼ é€’å†…å®¹ <code>T</code>ï¼Œä¸€ä¸ªç”¨æ¥å¤„ç†é”™è¯¯</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>RxJob</code> æ‰§è¡Œçš„å†…å®¹æœ€ç»ˆéƒ½æ˜¯ <code>doJob(RxCallback&lt;T&gt; rxCallback)</code> æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯é“¾æ¥èµ·æ‰€æœ‰å›è°ƒçš„æ ¸å¿ƒ</p>
<p>ä¿è¯äº†æ‰€æœ‰çš„æ–¹æ³•èƒ½ä¸€ä¸ªä¸€ä¸ªæ ¹æ®é“¾å¼è°ƒç”¨ä¸€ä¸ªä¸€ä¸ªæ‰§è¡Œ</p>
<h3 id="åˆ›å»ºåŒ…è£¹ç±»-new-rxjob">åˆ›å»ºåŒ…è£¹ç±» <code>new RxJob(..)</code></h3>
<p>ç›´æ¥å¸¦å…¥å½“å‰çš„æ —å­ä¸­ï¼Œä»£ç å¦‚ä¸‹</p>
<pre><code class="language-java">RxJob&lt;List&lt;Photo&gt;&gt; queryPhotoJob = new RxJob&lt;List&lt;Photo&gt;&gt;(){
  	        @Override
                public void doJob(final RxCallback&lt;List&lt;Photo&gt;&gt; rxCallback) {
                    mApi.queryPhoto(&quot;flyer&quot;, new Api.QueryCallback() {
                        @Override
                        public void onQuerySuccess(List&lt;Photo&gt; photoList) {
                            rxCallback.onNext(photoList);
                        }
                      

                        @Override
                        public void onQueryFailed(Exception e) {
                            rxCallback.onError(e);
                        }
                    });
                }
            };
};
</code></pre>
<p>å…¶ä¸­<code>RxJob&lt;T&gt;</code> ä¸­çš„ <code>T</code> çš„å€¼æ˜¯ <code>List&lt;Photo&gt;</code>ï¼Œè¿™ä¸»è¦å†³å®šäº <code>mApi.queryPhoto()</code> ä¸­ <code>onQuerySuccess(List&lt;Photo&gt; photoList)</code> ä¸­çš„å‚æ•°ç±»å‹ï¼Œè®© <code>rxCallback.onNext(photoList)</code> èƒ½å–åˆ°å¯¹åº”çš„ç±»å‹ã€‚ä»è€ŒæŠŠæ‹¿åˆ°çš„æ•°æ®å†…å®¹ï¼Œå€ŸåŠ© <code>RxCallback</code> å›è°ƒå¾€å¤–å±‚æŠ›å‡ºã€‚</p>
<p>å³ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦è°ƒç”¨ <code>queryPhotoJob</code> ï¼Œè®©ä»–æ‰§è¡Œå¯¹åº”çš„æ“ä½œä»£ç å¦‚ä¸‹</p>
<pre><code class="language-java">queryPhotoJob.doJob(new RxCallback&lt;List&lt;Photo&gt;&gt;(){
  	public void onNext(List&lt;Photo&gt; photoList){
           Photo photo = getBestPhoto(photoList);
           String imgUrl = photo.getUrl();
  	}
  	public void onError(Exception e){...}
});
</code></pre>
<h3 id="æ ¸å¿ƒéƒ¨åˆ†-map-å‡½æ•°å¦‚ä½•å®ç°">æ ¸å¿ƒéƒ¨åˆ† map å‡½æ•°å¦‚ä½•å®ç°</h3>
<p>é¦–å…ˆå¯ä»¥ç¡®å®šçš„æ˜¯ map å‡½æ•°è¿”å›çš„ç±»å‹è‚¯å®šæ˜¯ <code>RxJob</code>ï¼Œå› ä¸º <code>map</code>æ–¹æ³•æ˜¯å¯ä»¥è¿ç»­è°ƒç”¨çš„ï¼Œ</p>
<p>å…¶æ¬¡ï¼Œå¯ä»¥ç¡®å®š <code>map</code> å‡½æ•°çš„å…¥å‚æ˜¯ <code>Func</code>ï¼Œ</p>
<p>ä¸€ä¸ªåŒ¿åå†…éƒ¨ç±»ï¼ˆ<code>Java 8</code> ä¸­çš„ <code>Lambda</code> è¡¨è¾¾å¼ï¼‰ï¼Œåœ¨å…¶ä»–æŸäº›è¯­è¨€ä¸­å°±æ˜¯å‡½æ•°å¯¹è±¡ã€å‡½æ•°å¼•ç”¨ä¹‹ç±»çš„</p>
<p>ç”±æ­¤å¯ä»¥ç¡®å®š <code>map</code> æ–¹æ³•åŸºæœ¬çš„æ ·å­å¦‚ä¸‹ä»£ç ï¼š</p>
<pre><code class="language-java">public RxJob map(Func&lt;T,R&gt; func){
  	...
    return rxJob;
};
</code></pre>
<p>ç„¶åè€ƒè™‘å…¥å‚ <code>Func&lt;T,R&gt; func</code> çš„å®ç°ï¼Œå³è¿™ä¸ªè½¬å˜å‡½æ•°è¯¥å¦‚ä½•å®ç°ã€‚</p>
<h4 id="1-è½¬å˜å‡½æ•°çš„ç¡®å®š">1. è½¬å˜å‡½æ•°çš„ç¡®å®š</h4>
<p>é¦–å…ˆå¯ä»¥ç¡®å®šè¿™ä¸ªåŒ¿åå†…éƒ¨ç±»ä¼šå®ç°ä¸€ä¸ªä» <code>T ç±»å‹â€”&gt; R ç±»å‹</code>çš„è½¬æ¢ï¼Œ</p>
<p>å…¶æ¬¡ <code>func</code> å¯¹è±¡æ˜¯åœ¨ map æ–¹æ³•è°ƒç”¨çš„æ—¶å€™ï¼Œæ‰ç¡®å®šå…·ä½“çš„å®ç°å†…å®¹ï¼Œå› æ­¤ï¼Œå®ƒå¿…ç„¶æ˜¯ä¸€ä¸ªæ¥å£æˆ–è€…æŠ½è±¡æ–¹æ³•ï¼Œå¾…å®ç°</p>
<p>ç„¶åï¼Œè€ƒè™‘åˆ° <code>T ç±»å‹â€”&gt; R ç±»å‹</code> çš„è½¬æ¢åœ¨å…·ä½“ä»£ç ç¼–å†™çš„æ—¶å€™æ˜¯å¯ä»¥ç¡®å®šçš„ï¼Œç”±æ­¤è€ƒè™‘å¯ä»¥ç”¨æ³›å‹æ–¹æ³•å’Œæ³›å‹ç±»å°±å¯ä»¥å®ç°ã€‚</p>
<p>ä»è€Œåˆ›å»º <code>Func&lt;T,R&gt;</code> æ¥å£ï¼Œè¯¥æ¥å£æœ‰ä¸€ä¸ª <code>R call(T t)</code> æ–¹æ³•å¾…å®ç°</p>
<p>çœ‹å¦‚ä¸‹ä»£ç ï¼š</p>
<pre><code class="language-java">public interface Func&lt;T,R&gt; {
    /**
     *
     * @param t transform çš„å¯¹è±¡ç±»å‹
     * @return è¿”è¿˜çš„å¯¹è±¡ç±»å‹
     */
    R call(T t);
}
</code></pre>
<p>è¯¥æ–¹æ³•è¿”å›çš„ç±»å‹ï¼Œæ˜¯æ³›å‹ç±» <code>Func&lt;T,R&gt;</code> ä¸­çš„ <code>R</code>ï¼Œå…¶å…¥å‚æ˜¯æ³›å‹ç±» <code>Func&lt;T,R&gt;</code> ä¸­çš„ <code>T</code></p>
<p>å³è¯¥ç±»çš„ä½œç”¨å°±æ˜¯è¿›è¡Œä¸€ä¸ªä» <code>T â€”&gt; R</code> çš„è½¬æ¢ï¼Œè€Œå…·ä½“çš„è½¬æ¢æ–¹æ³•ç”±å¤–éƒ¨å®ç°ã€‚</p>
<p>åº”ç”¨åˆ°ä¸Šé¢çš„ä¾‹å­å°±æ˜¯ï¼Œ<code>List â€”&gt; Photo</code> çš„è½¬æ¢ï¼Œå³ <code>R call&lt;T t&gt;</code> æ–¹æ³• å˜æˆäº† <code>Photo call&lt;List photoList&gt;</code></p>
<p>äºæ˜¯ä¹ï¼Œä»£ç å°±å˜æˆäº†å¦‚ä¸‹çš„æ ·å­</p>
<pre><code class="language-java">RxJob queryPhotoJob = new RxJob(..)...;
queryPhotoJob
  .map(new Func&lt;List&lt;Photo&gt;,Photo&gt;()
            @Overide
            Photo call(List&lt;Photo&gt; photoList){
			    return getBestPhoto(photoList);
  			})
  // åŒç†ç¬¬äºŒä¸ª map å°±æˆäº†å¦‚ä¸‹ï¼Œ
  // å…¥å‚æ˜¯ä¸Šä¸ªæ“ä½œçš„å‡ºå‚ Photo
  // è€Œå‡ºå‚åˆ™æ˜¯ String ç±»å‹çš„
  .map(new Func&lt;Photo,String&gt;(){
            @Overide
            String call(Photo photo){
                return photo.getUrl()//è¿”è¿˜ String ç±»å‹
            }
          })
  .doJob(...);
</code></pre>
<p>è‡³æ­¤ï¼Œ<code>map</code> å‡½æ•°çš„å…¥å‚æ•´ä½“å·²ç»ä»‹ç»å®Œæ¯•ã€‚</p>
<h4 id="2dojob-æ–¹æ³•çš„è°ƒç”¨">2.<code>doJob</code> æ–¹æ³•çš„è°ƒç”¨</h4>
<p>ç„¶åè€ƒè™‘é‡Œé¢å…·ä½“çš„è°ƒç”¨é€»è¾‘ï¼Œé¦–å…ˆè€ƒè™‘ä»»åŠ¡è°ƒç”¨ï¼Œç¬¬ä¸€ä¸ª <code>map</code> æ–¹æ³•åœ¨è§¦å‘çš„æ—¶å€™ï¼Œ<code>queryPhotoJob</code> æœ¬èº«å·²ç»æ˜¯ä¸€ä¸ª <code>RxJob</code> å¯¹è±¡äº†</p>
<p>å®ƒçš„å®ç°å†…å®¹ä¹Ÿç®€å•ï¼Œåœ¨åˆ›å»ºåŒ…è£¹ç±»æ—¶å·²ç»æœ‰è§£é‡Šäº†ã€‚</p>
<pre><code class="language-java">queryPhotoJob.doJob(new RxCallback&lt;List&lt;Photo&gt;&gt;(){
  	public void onNext(List&lt;Photo&gt; photoList){..}
  	public void onError(Exception e){...}
});
</code></pre>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘è¦è°ƒç”¨ <code>map</code> æ–¹æ³•è§¦å‘ä¼ å…¥çš„ <code>func</code> åŒ¿åå†…éƒ¨ç±»ï¼Œå°±å¿…é¡»å…ˆè°ƒç”¨ <code>queryPhotoJob.doJob(..)</code></p>
<p>äºæ˜¯æŠŠä»£ç å˜æˆ</p>
<pre><code class="language-java">public RxJob map(Func&lt;T,R&gt; func){
  rxJob.doJob(new RxCallback&lt;T&gt;() {
      @Override
      public void onNext(T t) {
      }

      @Override
      public void onError(Exception e) {
      }
    });
  return ...;
};
</code></pre>
<p>åº”ç”¨åˆ°ä¸Šè¿°ä¾‹å­ä¸­å…¶å…·ä½“çš„æ³›å‹å€¼å˜åŒ–å°±æˆäº†å¦‚ä¸‹ä»£ç </p>
<pre><code class="language-java">public RxJob map(Func&lt;List&lt;Photo&gt;,R&gt; func){
  rxJob.doJob(new RxCallback&lt;List&lt;Photo&gt;&gt;() {
      @Override
      public void onNext(List&lt;Photo&gt; photoList) {
      }

      @Override
      public void onError(Exception e) {
      }
    });
  return ...;
};
</code></pre>
<p>æ­¤æ—¶éœ€è¦è€ƒè™‘çš„å°±æ˜¯åœ¨å“ªé‡Œè°ƒç”¨ <code>func</code> å‡½æ•°ï¼Œå®ƒæ˜¯è´Ÿè´£æŠŠ<code>T â€”&gt; R</code> ï¼Œ</p>
<p>å› æ­¤è¯¥éƒ¨åˆ†ä»£ç å¿…ç„¶æ˜¯åœ¨å½“å‰ä»»åŠ¡æ‰§è¡Œå®Œåï¼Œæ‹¿åˆ°å½“å‰ä»»åŠ¡çš„å›è°ƒå€¼ï¼Œç„¶åè¿›è¡Œè½¬æ¢ï¼Œå³ <code>map</code> æ–¹æ³•ä¼šå˜æˆå¦‚ä¸‹</p>
<pre><code class="language-java">public RxJob map(Func&lt;T,R&gt; func){
  rxJob.doJob(new RxCallback&lt;T&gt;() {
      @Override
      public void onNext(T t) {
        R mapped = func.call(t);
      }

      @Override
      public void onError(Exception e) {
      }
    });
  return ...;
};
</code></pre>
<h4 id="3-map-æ–¹æ³•è¿”è¿˜å€¼">3. <code>map</code> æ–¹æ³•è¿”è¿˜å€¼</h4>
<p>æ¥ä¸‹æ¥è€ƒè™‘è¿”å›å€¼ï¼Œé¦–å…ˆ <code>map</code> æ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ª <code>RxJob</code>å¯¹è±¡</p>
<p>å…¶æ¬¡ï¼Œå› ä¸ºå½“å‰ä»»åŠ¡å·²ç»æ‰§è¡Œå®Œäº†ï¼Œè€Œä¸‹ä¸€ä¸ªä»»åŠ¡éœ€è¦å½“å‰ä»»åŠ¡æ‰§è¡Œåå¤„ç†çš„è¿”å›å€¼ï¼Œå³<code>func.call(t)</code> è¿”å›çš„ <code>mapped</code> å€¼</p>
<p>å¦‚æœè¿”å›çš„æ˜¯åŸæœ‰çš„ <code>RxJob</code> é‚£ä¹ˆæ¯æ¬¡è°ƒç”¨ <code>map</code> æ–¹æ³•æ—¶æ‰§è¡Œçš„ä»£ç æ°¸è¿œæ˜¯ <code>this.doJob</code> å› æ­¤æ¯æ¬¡æ‰§è¡Œçš„å†…å®¹éƒ½æ˜¯ç¬¬ä¸€ä¸ªä»»åŠ¡äº†</p>
<p>åº”ç”¨åˆ°æ­¤å¤„å°±æ˜¯ <code>queryPhotoJob.doJob(..)</code>ã€‚</p>
<p>å› æ­¤ <code>map</code> æ–¹æ³•è¿”å›çš„å€¼åº”è¯¥æ˜¯ä¸€ä¸ªæ–°åˆ›å»ºçš„ <code>RxJob</code> å¯¹è±¡ï¼Œå¹¶ä¸”è¯¥å¯¹è±¡çš„ <code>doJob</code> æ–¹æ³•ä¼šå…ˆè¿è¡Œå½“å‰ä»»åŠ¡çš„ <code>doJob</code> æ–¹æ³•</p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-java">public RxJob map(Func&lt;T,R&gt; func){
  	 RxJob curJob = this;
      return new RxJob() {
            @Override
            public void doJob(final RxCallback rxCallback) {
                curJob.doJob(new RxCallback&lt;T&gt;() {
                    @Override
                    public void onNext(T t) {
                        R mapped = func.call(t);
                      	...
                    }

                    @Override
                    public void onError(Exception e) {
                        ...
                    }
                });
            }
        };
};
</code></pre>
<p>æŠŠå½“å‰ä¾‹å­çš„æ³›å‹å€¼å¸¦å…¥å¦‚ä¸‹ï¼š</p>
<pre><code class="language-java">public RxJob map(Func&lt;List&lt;Photo&gt;,R&gt; func){
  	 RxJob queryPhotoJob = this;
     RxJob mapJob = new RxJob() {
            @Override
            public void doJob(final RxCallback rxCallback) {
                queryPhotoJob.doJob(new RxCallback&lt;List&lt;Photo&gt;&gt;() {
                    @Override
                    public void onNext(List&lt;Photo&gt; photoList) {
                        R mapped = func.call(photoList);
                      	...
                    }

                    @Override
                    public void onError(Exception e) {
                        ...
                    }
                });
            }
        };
  return mapJob;
};
</code></pre>
<h4 id="4-funccall-çš„è¿”è¿˜å€¼ä¼ é€’">4. <code>func.call()</code> çš„è¿”è¿˜å€¼ä¼ é€’</h4>
<p>è€ƒè™‘å¦‚ä½•æŠŠ <code>func.call()</code> è°ƒç”¨åçš„è¿”å›çš„æ•°æ®å¾€ä¸‹ä¸€ä¸ª <code>RxJob</code> ä¼ é€’</p>
<p>ç›´æ¥è°ƒç”¨ä¸‹ä¸€ä¸ª <code>RxJob</code> ä¸­å›è°ƒçš„ <code>rxCallback.onNext()</code>æ–¹æ³•å³å¯ï¼Œå¯¹äºé”™è¯¯ä¹ŸåŒæ ·è°ƒç”¨ <code>rxCallback.onError(e)</code> å³å¯ã€‚</p>
<pre><code class="language-java">public RxJob map(Func&lt;T,R&gt; func){
  	 RxJob curJob = this;
      return new RxJob() {
            @Override
            public void doJob(final RxCallback rxCallback) {
                curJob.doJob(new RxCallback&lt;T&gt;() {
                    @Override
                    public void onNext(T t) {
                        R mapped = func.call(t);
                      	rxCallback.onNext(t);
                    }

                    @Override
                    public void onError(Exception e) {
                        rxCallback.onError(e);
                    }
                });
            }
        };
}
</code></pre>
<p>ä»£å…¥å½“å‰ä¾‹å­ï¼š</p>
<pre><code class="language-java">public RxJob map(Func&lt;List&lt;Photo&gt;,R&gt; func){
  	 RxJob&lt;List&lt;Photo&gt;&gt; queryPhotoJob = this;
     RxJob mapJob = new RxJob() {
            @Override
            public void doJob(final RxCallback mapJobCallback) {
                queryPhotoJob.doJob(new RxCallback&lt;List&lt;Photo&gt;&gt;() {
                    @Override
                    public void onNext(List&lt;Photo&gt; photoList) {
                        R mapped = func.call(photoList);
                      	mapJobCallback.onNext(mapped);
                    }

                    @Override
                    public void onError(Exception e) {
                        mapJobCallback.onError(e);
                    }
                });
            }
        };
  return mapJob;
}
</code></pre>
<p>æœ€ç»ˆåªéœ€è¦ç¡®å®šæ³›å‹å‚æ•°ç±»å‹ <code>R</code>ï¼Œä»–çš„ä½œç”¨æ˜¯ç¡®å®šä¸‹ä¸€ä¸ª<code>RxJob</code> å¯¹è±¡çš„æ³›å‹å€¼</p>
<p><code>R</code> ç”± <code>func.call()</code> æ–¹æ³• ç¡®å®šï¼Œä¹Ÿå°±æ˜¯ä¹‹å‰è¯´çš„ï¼Œåœ¨å…·ä½“çš„ <code>map</code> æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œå‚æ•°çš„æ³›å‹å€¼æ˜¯å¯ä»¥ç¡®å®šçš„</p>
<p><code>Func</code> å‡½æ•°è´Ÿè´£æŠŠ T â€”&gt; R è½¬æ¢ï¼Œå› æ­¤ï¼Œæœ€ç»ˆçš„ <code>map</code> æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<pre><code class="language-java">public &lt;R&gt; RxJob&lt;R&gt; map(Func&lt;T,R&gt; func){
      RxJob curJob = this;
      return new RxJob&lt;R&gt;() {
            @Override
            public void doJob(final RxCallback&lt;R&gt; rxCallback) {
                curJob.doJob(new RxCallback&lt;T&gt;() {
                    @Override
                    public void onNext(T t) {
                        R mapped = func.call(t);
                        rxCallback.onNext(mapped);
                    }

                    @Override
                    public void onError(Exception e) {
                        rxCallback.onError(e);
                    }
                });
            }
        };
  }
</code></pre>
<p>åº”ç”¨åˆ°å½“å‰ä¾‹å­ï¼Œå¸¦å…¥æ³›å‹å€¼å¦‚ä¸‹</p>
<pre><code class="language-java">public&lt;Photo&gt; RxJob&lt;Photo&gt; map(Func&lt;List&lt;Photo&gt;,Photo&gt; func){
  	 RxJob&lt;List&lt;Photo&gt;&gt; queryPhotoJob = this;
     RxJob&lt;Photo&gt; mapJob = new RxJob&lt;Photo&gt;() {
            @Override
            public void doJob(final RxCallback&lt;Photo&gt; mapJobCallback) {
                queryPhotoJob.doJob(new RxCallback&lt;List&lt;Photo&gt;&gt;() {
                    @Override
                    public void onNext(List&lt;Photo&gt; photoList) {
                        Photo mapped = func.call(photoList);
                      	mapJobCallback.onNext(mapped);
                    }

                    @Override
                    public void onError(Exception e) {
                        mapJobCallback.onError(e);
                    }
                });
            }
        };
  return mapJob;
}
</code></pre>
<h3 id="æ•´ä¸ªä»»åŠ¡å¦‚ä½•è¿è¡Œ">æ•´ä¸ªä»»åŠ¡å¦‚ä½•è¿è¡Œ</h3>
<pre><code class="language-java">RxJob&lt;List&lt;Photo&gt;&gt; queryPhotoJob = new RxJob&lt;List&lt;Photo&gt;&gt;(){
  				@Override
                public void doJob(final RxCallback&lt;List&lt;Photo&gt;&gt; rxCallback) {
                    mApi.queryPhoto(&quot;flyer&quot;, new Api.QueryCallback() {
                        @Override
                        public void onQuerySuccess(List&lt;Photo&gt; photoList) {
                            rxCallback.onNext(photoList);
                        }
                      

                        @Override
                        public void onQueryFailed(Exception e) {
                            rxCallback.onError(e);
                        }
                    });
                }
            };
};
RxJob&lt;Photo&gt; bestPhotoJob = queryPhotoJob.map(photoList -&gt; { return getBestPhoto(photoList);})
RxJob&lt;String&gt; urlJob = .map(photo -&gt; {return photo.getUrl();})
urlJob.doJob(new RxCallback&lt;String&gt;() {
            @Override
            public void onNext(String s) {
				ToastUtils.show(s);
            }

            @Override
            public void onError(Exception e) {
				...
            }
   });
</code></pre>
<p>è§£é‡Šä»£ç ï¼Œç¬¬ä¸€ä¸ª <code>map</code> æ–¹æ³• è¿”è¿˜äº†ä¸€ä¸ª <code>RxJob&lt;Photo&gt;</code> å¯¹è±¡ï¼Œç¬¬äºŒä¸ª <code>map</code> è¿”è¿˜äº†ä¸€ä¸ª <code>RxJob&lt;String&gt;</code> å¯¹è±¡ï¼Œç¬¬ä¸‰ä¸ª <code>doJob</code> æ–¹æ³•è§¦å‘æ•´ä¸ªä»»åŠ¡</p>
<p><code>doJob</code> æ–¹æ³•è§¦å‘çš„ç¬¬ä¸€ä¸ªæ–¹æ³•æ˜¯ <code>urlJob</code> ä¸­çš„ <code>doJob</code> æ–¹æ³•ï¼Œç”±äº <code>urlJob</code> å¯¹è±¡æ˜¯ç”± <code>map</code> æ–¹æ³•åˆ›å»ºçš„</p>
<p>å› æ­¤ï¼Œåœ¨æ‰§è¡Œ <code>ToastUtils.show(s)</code> æ–¹æ³•ä¹‹å‰ï¼Œä¼šå…ˆæ‰§è¡Œ <code>bestPhotoJob.doJob()</code></p>
<p>åŒæ ·ï¼Œ<code>queryPhotoJob.doJob()</code>ä¹Ÿä¼šæ‰§è¡Œåœ¨ <code>bestPhotoJob.doJob()</code> æ–¹æ³•ä¹‹å‰</p>
<p>å› æ­¤æ•´ä½“è¿‡ç¨‹å°±æ˜¯ <code>queryPhotoJob.doJob()</code>â€”&gt; <code>bestPhotoJob.doJob()</code> â€”&gt; <code>urlJob.doJob()</code></p>
<p>è€Œè¿™æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œ<code>R mapped = func.call(T)</code> ä¼šå…ˆè¢«è°ƒç”¨ï¼Œå› æ­¤å•ä¸ª <code>RxJob</code> è°ƒç”¨é“¾å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>åœ¨è°ƒç”¨æ¯ä¸ª <code>RxJob.onNex()</code>æƒ…å†µä¸‹(å³æˆåŠŸçš„æƒ…å†µä¸‹ï¼Œæ²¡æœ‰å‡ºé”™)</p>
</blockquote>
<p><code>queryPhotoJob.doJob()</code> : <code>mApi.query</code> â€”&gt; <code>func.call(t)</code> â€”&gt; <code>getBestPhoto(photoList)</code></p>
<p><code>bestPhotoJob.doJob()</code> ï¼š <code>func.call(t)</code> â€”&gt; <code>photo.getUrl()</code></p>
<p><code>urlJob.doJob()</code>ï¼š  <code>ToastUtil.show()</code></p>
<p>æ¯”è¾ƒç‚«é…·çš„å†™æ³•å¦‚ä¸‹ï¼š</p>
<pre><code class="language-java">RxJob&lt;List&lt;Photo&gt;&gt; queryPhotoJob = new RxJob&lt;List&lt;Photo&gt;&gt;(){
  				@Override
                public void doJob(final RxCallback&lt;List&lt;Photo&gt;&gt; rxCallback) {
                    mApi.queryPhoto(&quot;flyer&quot;, new Api.QueryCallback() {
                        @Override
                        public void onQuerySuccess(List&lt;Photo&gt; photoList) {
                            rxCallback.onNext(photoList);
                        }
                      

                        @Override
                        public void onQueryFailed(Exception e) {
                            rxCallback.onError(e);
                        }
                    });
                }
            };
};
queryPhotoJob
  .map(photoList -&gt; { return getBestPhoto(photoList);})
  .map(photo -&gt; {return photo.getUrl()})
  .doJob(...);
</code></pre>
<p>=================================</p>
<p><a href="">å¼‚æ­¥é‡Œé¢è¿˜æœ‰å¼‚æ­¥æ–¹æ³•ï¼Œ<code>flatMap</code> å¾…ç»­</a></p>
<p>=================================</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ã€æ—§ã€‘Android è´å¡å°”æ›²çº¿ï¼ŒQQ åˆ é™¤å°çº¢ç‚¹ç±»ä¼¼æ•ˆæœå®ç°]]></title>
        <id>https://flyer88.github.io/post/jiu-android-bei-sai-er-qu-xian-qq-shan-chu-xiao-hong-dian-lei-si-xiao-guo-shi-xian/</id>
        <link href="https://flyer88.github.io/post/jiu-android-bei-sai-er-qu-xian-qq-shan-chu-xiao-hong-dian-lei-si-xiao-guo-shi-xian/">
        </link>
        <updated>2020-06-15T09:50:35.000Z</updated>
        <content type="html"><![CDATA[<blockquote>
<p>å†™äº 2015 å¹´ 11 æœˆ 16 æ—¥</p>
</blockquote>
<p>å…·ä½“çš„å®ç°</p>
<ul>
<li>é¦–å…ˆåç§»é‡</li>
<li>ç„¶åæ˜¯è®¡ç®—è´å¡å°”æ›²çº¿</li>
<li>æ¥ä¸‹æ¥å°±æ˜¯è®¡ç®—æ§åˆ¶ç‚¹o,p<br>
çœ‹åˆ° QQ æ‹–åŠ¨åˆ é™¤å°çº¢ç‚¹çš„åŠ¨ç”»æ•ˆæœï¼Œå°±æƒ³ç€åšä¸ªç±»ä¼¼çš„æ•ˆæœï¼Œæ²¡æ‰¾åˆ°Android ç‰ˆçš„æ•™ç¨‹ï¼Œäºæ˜¯å°±è‡ªå·±æ’¸äº†ä¸€ä¸ªï¼Œä»£ç åœ°å€ï¼šhttps://github.com/flyer88/JellyCircle/tree/master/circleindicator ï¼Œè¯¥æ —å­çš„å®ç°åœ¨circleIndicatoråŒ…ä¸­ï¼ŒappåŒ…ä¸‹æ˜¯å¦ä¸€ä¸ªdemoï¼Œè¿˜æ²¡å†™å¥½ã€‚</li>
</ul>
<figure data-type="image" tabindex="1"><img src="https://flyer88.github.io/post-images/1592214669097.gif" alt="img" loading="lazy"></figure>
<figure data-type="image" tabindex="2"><img src="https://flyer88.github.io/post-images/1592214679012.gif" alt="img" loading="lazy"></figure>
<figure data-type="image" tabindex="3"><img src="https://flyer88.github.io/post-images/1592214687544.gif" alt="img" loading="lazy"></figure>
<p>æ³¨æ„ï¼šä¸ºå®ç°ä¸Šé¢é“¾æ¥ä¸­æ‰€ç¤ºçš„åŠ¨ç”»ï¼Œé¦–å…ˆç¡®å®šï¼Œä¸¤ä¸ªåœ†éšç€åç§»é‡çš„æ”¹å˜ï¼ŒåŠå¾„å¤§å°å‡ºç°äº†å˜åŒ–ï¼ŒåŒæ—¶è´å¡å°”æ›²çº¿æœ‰æ‰€å˜åŒ–ï¼Œé‚£å‰©ä¸‹çš„é—®é¢˜å°±æ˜¯å¦‚ä½•æ”¹å˜ä¸¤ä¸ªåœ†çš„åŠå¾„å¤§å°ï¼Œåœ†çš„ä½ç½®ï¼ŒåŒæ—¶è®¡ç®—å’Œç»˜åˆ¶è´å¡å°”æ›²çº¿</p>
<h1 id="æ¥ä¸‹æ¥çœ‹å…·ä½“çš„å®ç°">æ¥ä¸‹æ¥çœ‹å…·ä½“çš„å®ç°</h1>
<h3 id="é¦–å…ˆåç§»é‡">é¦–å…ˆåç§»é‡</h3>
<p>æˆ‘æ­¤å¤„ç»™çš„å€¼æ¯”è¾ƒç®€å•ï¼Œç›´æ¥é€šè¿‡<code>SeekBar</code>æ¥è·å–åç§»é‡</p>
<p>è·å–åç§»é‡åï¼Œéœ€è¦æ”¹å˜çš„æ•°æ®æœ‰ï¼ŒåŠå¾„å¤§å°ï¼Œä»¥åŠç¬¬äºŒä¸ªåœ†çš„ä½ç½®ï¼Œä»¥åŠè´å¡å°”æ›²çº¿çš„é‡æ–°ç»˜åˆ¶</p>
<p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code>    mEndCircle.setX(dpToPx(mDefaultFirstX + mMaxDistance * offset,getResources()));//ä¿®æ”¹ç¬¬äºŒä¸ªåœ†çš„ä½ç½®
    mEndCircle.setRadius(dpToPx(mDefaultMinRadius,getResources()) + offset * dpToPx(mDefaultMaxRadius - mDefaultMinRadius,getResources()));//ç¬¬äºŒä¸ªåœ†åŠå¾„å˜å¤§
    mStartCircle.setRadius(dpToPx(mDefaultMaxRadius,getResources()) - offset * dpToPx(mDefaultMaxRadius - mDefaultMinRadius,getResources()));//ç¬¬ä¸€ä¸ªåœ†åŠå¾„å˜å°
    mCanDrawBezier = calculatePoint(mStartCircle, mEndCircle);//è®¡ç®—è´å¡å°”æ›²çº¿
    invalidate();//åˆ·æ–°ï¼Œè§¦å‘onDraw()ï¼Œé‡æ–°ç»˜åˆ¶
</code></pre>
<h3 id="ç„¶åæ˜¯è®¡ç®—è´å¡å°”æ›²çº¿">ç„¶åæ˜¯è®¡ç®—è´å¡å°”æ›²çº¿</h3>
<p>çœ‹ä¸‹å›¾ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥ç¡®å®šå‡ºæœ‰ä¸¤æ¡æ›²çº¿ï¼Œæˆ‘æ²¡æœ‰ç”»ä¸¤æ¡æ›²çº¿ï¼Œè€Œæ˜¯ä¸€æ¡<code>mBezierPath</code>æå®š</p>
<p>A-&gt;B-&gt;C-&gt;D-&gt;Aï¼ˆå…³äºæ§åˆ¶ç‚¹å“¦o,påé¢ä¼šæœ‰è®¡ç®—åˆ†æï¼ŒåŸºæœ¬æŒ‰ç…§ä¸Šå›¾ä¸­æ‰€å†™å°±å¯ä»¥è®¡ç®—å‡ºo,pä¸¤ç‚¹çš„ä½ç½®ï¼‰</p>
<figure data-type="image" tabindex="4"><img src="https://flyer88.github.io/post-images/1592214698011.jpg" alt="img" loading="lazy"></figure>
<p>å…¶ä¸­ï¼ŒAç‚¹æ˜¯å¼€å§‹ç‚¹ï¼Œç›´æ¥ <code>moveTo()</code> å³å¯ï¼Œç„¶åç”¨<code>lineTo()</code>åˆ°Bç‚¹,å†è°ƒç”¨ç³»ç»Ÿè‡ªå¸¦çš„è´å¡å°”æ›²çº¿æ–¹æ³•<code>quadTo(ponitP.x,pointP.y)</code>è®¡ç®—å³å¯ï¼Œç„¶åå°±æ˜¯ä¸€æ ·çš„<code>lineTo()</code>åˆ°Dç‚¹ï¼Œ<code>quadTo(pointO.x,pointP.y)</code>;</p>
<p>å…³äº<code>quadTo(x1,y1,x2,y2)</code>çš„ä½¿ç”¨ï¼Œå¯ä»¥å»ç™¾åº¦ä¸€ä¸‹ï¼Œç®€å•è¯´ä¸€ä¸‹ï¼Œå°±æ˜¯å‰é¢ä¸¤ä¸ªæ˜¯æ§åˆ¶ç‚¹ï¼Œåé¢ä¸¤ä¸ªæ˜¯åˆ°è¾¾çš„ç‚¹</p>
<p>è¿™æ ·<code>mBezierPath</code>åŸºæœ¬å°±ç”»å¥½äº†ï¼Œç„¶åç”»èµ·å§‹åœ†å’Œç»“æŸåœ†å°±å¯ä»¥äº†ï¼ˆå½“ç„¶ï¼Œå¦‚æœè€ƒè™‘åˆ°overdrawçš„è¯ï¼Œèµ·å§‹å¯ä»¥ç”¨clipRect clipRejectå»æ‰é‡å¤çš„åŠåœ†ï¼Œæ­¤å¤„å·æ‡’ï¼Œç›´æ¥ç”»äº†ä¸¤ä¸ªåœ†ï¼Œæ²¡æœ‰å»æ‰é‡å¤ç»˜åˆ¶ï¼Œæˆ–è€…ç›´æ¥ç”»ä¸€ä¸ªåŠåœ†ï¼Œå½“ç„¶åŠåœ†çš„æ•ˆæœå’Œåœ†æ˜¯ä¸ä¸€æ ·çš„ï¼‰</p>
<p>ä»¥ä¸‹æ˜¯æ„å»ºå‡º<code>mBezierPath</code>çš„ä»£ç </p>
<pre><code>    mBezierPath.reset();
    mBezierPath.moveTo(mStartA.getX(), mStartA.getY());
    mBezierPath.lineTo(mStartB.getX(), mStartB.getY());
    mBezierPath.quadTo(mControlPointP.getX(), mControlPointP.getY(), mEndC.getX(), mEndC.getY());
    mBezierPath.lineTo(mEndD.getX(), mEndD.getY());
    mBezierPath.quadTo(mControlPointO.getX(), mControlPointO.getY(), mStartA.getX(), mStartA.getY());
</code></pre>
<h3 id="æ¥ä¸‹æ¥å°±æ˜¯è®¡ç®—æ§åˆ¶ç‚¹op">æ¥ä¸‹æ¥å°±æ˜¯è®¡ç®—æ§åˆ¶ç‚¹o,p</h3>
<p>ä»¥å›¾äºŒç®€å•çš„ä¸ºä¾‹å­ï¼Œè¿™ç§æ–¹å¼æ¯”è¾ƒæç«¯ï¼Œè®¡ç®—æ¯”è¾ƒå®¹æ˜“ï¼Œä¸¤ä¸ªæ§åˆ¶ç‚¹p,oå’ŒHç‚¹é‡åˆï¼Œç›´æ¥(R1(x,y)+R2(x,y))/2 = H(x,y)</p>
<p>å›¾ä¸€ä¹Ÿä¸éº»çƒ¦ï¼Œæ ¹æ®å›¾ä¸€æ ‡æ³¨Î¸ä¹Ÿå¯ä»¥ç®—å‡ºo,pä¸¤ç‚¹çš„x,y,å…·ä½“å®ç°å¯ä»¥çœ‹githubä»£ç </p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ã€æ—§ã€‘Android ä»£ç æ··æ·†(äºŒ)]]></title>
        <id>https://flyer88.github.io/post/jiu-android-dai-ma-hun-yao-er/</id>
        <link href="https://flyer88.github.io/post/jiu-android-dai-ma-hun-yao-er/">
        </link>
        <updated>2020-06-15T09:48:50.000Z</updated>
        <content type="html"><![CDATA[<blockquote>
<p>å†™äº 2016 å¹´ 08 æœˆ 13 æ—¥</p>
</blockquote>
<ul>
<li>åŸºæœ¬æ“ä½œåŠæ•´ä½“çš„æµç¨‹</li>
<li>æ³¨æ„äº‹é¡¹
<ul>
<li>warning å¤„</li>
<li>å¤šä¸ª module çš„æ··æ·†</li>
<li>åå°„çš„å¤„ç†</li>
<li>JavaScript çš„å¤„ç†</li>
<li>å¸¸ç”¨ç³»ç»Ÿå’Œç¬¬ä¸‰æ–¹åº“çš„æ··æ·†è§„åˆ™</li>
<li>@keep æ³¨è§£æ¥é¿å¼€æ··æ·†</li>
</ul>
</li>
</ul>
<p>Android ä»£ç æ··æ·†(ä¸€) ä¸­å·²ç»è®°å½•å¹¶èµ°äº†æ··æ·†çš„æ•´ä¸ªæµç¨‹ï¼Œç”¨å‘½ä»¤è¡Œè¿›è¡Œæ··æ·†çš„æ“ä½œï¼Œå¹¶éªŒè¯äº†ä¸‰ä¸ªè¿‡ç¨‹ï¼Œè¿™ç¯‡æ–‡ç« ä¼šè®°å½•ä¸€ä¸‹åœ¨ <code>Android Studio</code> ä¸‹æ··æ·†çš„æ“ä½œï¼Œä»¥åŠå…·ä½“éœ€è¦çš„æ³¨æ„çš„ä¸€äº›äº‹é¡¹ã€‚</p>
<h4 id="åŸºæœ¬æ“ä½œåŠæ•´ä½“çš„æµç¨‹">åŸºæœ¬æ“ä½œåŠæ•´ä½“çš„æµç¨‹</h4>
<p>1.ä¿®æ”¹<code>build.gradle</code>è„šæœ¬</p>
<pre><code>    buildTypes {
            release {
                minifyEnabled true//å¼€å¯æ··æ·†
                proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'//é…ç½®å†…å®¹
            }
            debug {
                minifyEnabled true//å¼€å¯æ··æ·†
                proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'//é…ç½®å†…å®¹
            }
        }
</code></pre>
<p>2.ä¿®æ”¹proguard-rules.proæ–‡ä»¶ï¼Œå†™å…¥åŸºç¡€çš„å‡ ä¸ªæ··æ·†è§„åˆ™ï¼Œé¿å¼€<code>Android</code>è‡ªå¸¦çš„ä¸€äº›ç±»</p>
<pre><code>    # å››å¤§ç»„ä»¶åŠåŸºæœ¬ç±»
    -keep public class * extends android.app.Activity
    -keep public class * extends android.app.Application
    -keep public class * extends android.app.Service
    -keep public class * extends android.content.BroadcastReceiver
    -keep public class * extends android.content.ContentProvider
    -keep public class * extends android.app.backup.BackupAgentHelper
    -keep public class * extends android.preference.Preference
    -keep public class com.android.vending.licensing.ILicensingService
    -keep public class * extends android.app.Fragment
    -keep public class * extends android.support.v4.**
    -keep public class * extends android.support.annotation.**
    -keep public class * extends android.support.v7.**
    -keep public class android.app.Notification
    -keep public class android.webkit.**
    #ä¿æŠ¤WebViewå¯¹HTMLé¡µé¢çš„APIä¸è¢«æ··æ·†
    -keep class **.Webview2JsInterface {*; }
    -keep public class * extends android.app.Dialog
    -keep public class * extends android.view

    # æ‰€æœ‰æšä¸¾ç±»å‹ä¸è¦æ··æ·†
    -keepclassmembers enum * {
    public static **[] values();
    public static ** valueOf(java.lang.String);
    }

    # ä¿æŒ native æ–¹æ³•ä¸è¢«æ··æ·†
    -keepclasseswithmembernames class * {
    native &lt;methods&gt;;
    }

    #ä¿æŒRæ–‡ä»¶ä¸è¢«æ··æ·†ï¼Œå¦åˆ™ï¼Œä½ çš„åå°„æ˜¯è·å–ä¸åˆ°èµ„æºidçš„
    -keep class **.R*{*;}

    # parcelable ä¸è¢«æ··æ·†
    -keep class * implements android.os.Parcelable {
    public static finalandroid.os.ParcelableCreator *;
    }

    #ä¿æŒå®ç°&quot;Serializable&quot;æ¥å£çš„ç±»ä¸è¢«æ··æ·†
    -keepnames class * implements java.io.Serializable

    #ä¿æŠ¤å®ç°æ¥å£Serializableçš„ç±»ä¸­ï¼ŒæŒ‡å®šè§„åˆ™çš„ç±»æˆå‘˜ä¸è¢«æ··æ·†
    -keepclassmembers class * implements java.io.Serializable {
    static final long serialVersionUID;
    private static final java.io.ObjectStreamField[] serialPersistentFields;
    !static !transient &lt;fields&gt;;
    !private &lt;methods&gt;;
    !private &lt;methods&gt;;
    private void writeObject(java.io.ObjectOutputStream);
    private void readObject(java.io.ObjectInputStream);
    java.lang.Object writeReplace();
    java.lang.Object readResolve();
    }
</code></pre>
<p>3.ç›´æ¥è·‘ä¸€ä¸ªdebugç‰ˆçš„è¿›è¡Œæµ‹è¯•ï¼ŒæŠŠæ‰“åŒ…å¥½çš„APKä¿®æ”¹æˆ.zipæ–‡ä»¶ï¼Œè§£å‹ï¼Œå–å‡ºæ–‡ä»¶ä¸­dexåŒ…ã€‚</p>
<figure data-type="image" tabindex="1"><img src="https://flyer88.github.io/post-images/1592214577248.jpg" alt="img" loading="lazy"></figure>
<p>æŠŠè§£å‹è·å–çš„<code>dex</code>æ–‡ä»¶ï¼Œé€šè¿‡ <a href="https://github.com/pxb1988/dex2jar">dex2jarå·¥å…·</a> (ä¸€ä¸ªæŠŠ<code>dex</code>åŒ…è½¬æ¢æˆ<code>jar</code>åŒ…çš„å·¥å…·)ï¼ŒæŠŠ<code>dex</code>è½¬æ¢æˆ<code>jar</code>åŒ…ã€‚å…¶å…·ä½“ä½¿ç”¨ä¸åœ¨æ­¤è¯¦ç»†è®²ã€‚</p>
<p>ä¸‹å›¾ä¸­æˆ‘æ²¡æœ‰æŠŠd2j-dex2jaré…ç½®è¿›ç¯å¢ƒå˜é‡ï¼Œæ‰€ä»¥è¿›å…¥å¯¹åº”ç›®å½•è·‘çš„è„šæœ¬ã€‚</p>
<figure data-type="image" tabindex="2"><img src="https://flyer88.github.io/post-images/1592214586829.jpg" alt="img" loading="lazy"></figure>
<p>è¿è¡Œå®Œåå¯ä»¥çœ‹åˆ°ï¼Œå½“å‰ç›®å½•ä¸‹å¤šäº†ä¸€ä¸ª<code>classes-dex2jar.jar</code>çš„æ–‡ä»¶</p>
<figure data-type="image" tabindex="3"><img src="https://flyer88.github.io/post-images/1592214601165.jpg" alt="img" loading="lazy"></figure>
<p>æ¥ä¸‹æ¥å°±æ˜¯å’Œå‰ä¸€ç¯‡æ–‡ç« ä¸€æ ·ï¼Œç›´æ¥ç”¨<code>Intelij</code>å¯¼å…¥ï¼Œçœ‹classæ–‡ä»¶ï¼ŒåŒ…å†…ç±»åå­—å·²æœ‰å˜åŒ–ï¼Œéƒ¨åˆ†ç±»å·²è¢«ç§»é™¤ï¼ŒåŒæ—¶éƒ¨åˆ†ç±»ä¹Ÿè¢«æ”¹æˆfinalç±»å‹ã€‚å…·ä½“å°±ä¸ä¸Šå›¾äº†ã€‚ä¸»è¦çœ‹ä¸‹é¢çš„æ³¨æ„äº‹é¡¹ã€‚</p>
<h4 id="æ³¨æ„äº‹é¡¹">æ³¨æ„äº‹é¡¹</h4>
<p>ä¸Šè¿°æµç¨‹åœ¨å¦‚æœæ˜¯é¡¹ç›®ä¸€å¼€å§‹å°±è¿›è¡Œæ··æ·†ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹æ˜¯èƒ½å¤ŸæˆåŠŸæ··æ·†ï¼Œå¹¶ä¸”ä¸ä¼šå‡ºç°å¾ˆå¤§é—®é¢˜ï¼Œåªéœ€è¦åœ¨é¡¹ç›®è¿›è¡Œè¿‡ç¨‹ä¸­æ³¨æ„ï¼Œæ–°åŠ çš„ç¬¬ä¸‰æ–¹ç±»åº“ï¼Œåå°„ä»£ç ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ é¢å¯¹çš„æ˜¯ä¸€ä¸ªæ²‰ç§¯å·²ä¹…ï¼Œå¹¶ä¸”é¡¹ç›®åºå¤§ï¼Œè€Œåˆä»æœªå†™è¿‡æ··æ·†çš„é¡¹ç›®ï¼Œé‚£ä½ å¯èƒ½ä¼šåœ¨æ··æ·†å¼€å¯æ—¶ï¼Œé¢ä¸´å‡ åƒä¸ªæ··æ·†æ—¶çš„<code>warning</code>å’Œ<code>note</code>ï¼Œæœ€ç»ˆæ— æ³•ç¼–è¯‘é€šè¿‡ã€‚è¿™ä¸­é—´ä¸»è¦æ˜¯å¤§é‡ç¬¬ä¸‰æ–¹åº“çš„æŠ¥é”™ã€‚ä¸‹é¢è®°å½•ä¸€ä¸‹æˆ‘åœ¨å¤„ç†è¿™ç§æƒ…å†µæ—¶ï¼Œé‡åˆ°çš„é—®é¢˜ä»¥åŠè§£å†³æ–¹æ¡ˆ</p>
<h5 id="warning-å¤„ç†">warning å¤„ç†</h5>
<p>å†™äº†ä¸ª<a href="https://github.com/flyer88/Some_Python_For_Android">è„šæœ¬</a>,ï¼Œè¿‡æ»¤å‡ºå¤§éƒ¨åˆ†é”™è¯¯ï¼Œç”Ÿæˆproguardæ–‡ä»¶ï¼Œç„¶åç»§ç»­å¤„ç†å‰©ä¸‹çš„ä¸ªåˆ«é—ç•™é—®é¢˜</p>
<p>å†™å‡ ä¸ªå…¸å‹çš„ä¾‹å­ï¼š</p>
<p>1.æƒ…å†µä¸€:</p>
<pre><code>    Note: xxxxxx calls 'Class.getEnclosingMethod'
    #è¿™ç§æƒ…å†µå°±æ˜¯è°ƒç”¨äº†åå°„ï¼Œæ‰¾åˆ°xxxxxå¯¹åº”è°ƒç”¨çš„ç±»ï¼Œå¹¶ä¸”è®¾ä¸ºå…¥å£ç‚¹ 
</code></pre>
<p>2.æƒ…å†µäºŒ:</p>
<pre><code>    Warning: AAAAAAA: can't find superclass or interface BBBBBBB
    Warning: AAAAAAA: can't find referenced class BBBBBBB 
    #è¿™ä¸¤ç§ç§æƒ…å†µå°±æ˜¯æ‰¾ä¸åˆ°BBBBBBäº†ï¼Œç›´æ¥æŠŠBBBBBè®¾ä¸ºå…¥å£ç‚¹ï¼ŒåŒæ—¶ç»™AAAAAæ‰“ä¸Š-dontwarnæ—¢å¯ä»¥,å¦‚ä¸‹
    -keep class BBBBBB
    -dontwarn AAAAAA
</code></pre>
<p>3.æƒ…å†µä¸‰:</p>
<pre><code>    Note:AAAAA accesses a declared field BBBBB dynamically 
        Maybe this is program field 'CCCCC'
        Maybe .....
    #è¿™ç§æƒ…å†µä¸‹ï¼Œéœ€è¦å¤„ç†CCCC,æŠŠå®ƒè®¾ä¸ºå…¥å£ç‚¹ï¼ŒåŒæ ·è®¾ç½®å¯¹AAAAAè®¾ç½®-dontwarn
    -keep class CCCCC
    #ä¸ä¸€å®šæ˜¯-keepï¼Œä¹Ÿæœ‰å¯èƒ½å…¶ä»–çš„ï¼Œä¾‹å¦‚ -keepattribute æ›´ä¸ºåˆé€‚
    -dontwarn AAAAA
</code></pre>
<h5 id="å¤šä¸ª-module-çš„æ··æ·†">å¤šä¸ª module çš„æ··æ·†</h5>
<p>æœ‰æ—¶å€™ä¼šç¢°åˆ°å¤šä¸ª<code>module</code>æ··æ·†çš„æƒ…å†µ,å¤šæ•°æƒ…å†µä¸‹ï¼Œä¸ºäº†æ¸…æ™°å¤„ç†ä¼šç»™æ¯ä¸ª<code>module</code>éƒ½å†™ä¸Šå¯¹åº”çš„æ··æ·†è§„åˆ™ï¼ŒåŒæ—¶éœ€è¦ä¿®æ”¹<code>build.gradle</code>çš„é…ç½®ï¼Œè€Œä¸æ˜¯ä¹‹å‰çš„å†™æ³•ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ<a href="http://stackoverflow.com/questions/30820915/android-studio-proguard-handling-in-multi-library-projects">soä¸Šçš„è§£é‡Š</a></p>
<p>è¿™ç§æ–¹æ¡ˆï¼Œéœ€è¦<code>module</code>ä¹‹é—´çš„ä¾èµ–æ¸…æ™°ï¼Œæœ€åº•å±‚çš„<code>module</code>ä¼šè¢«æœ€å…ˆæ··æ·†ï¼Œç„¶åä¸€æ­¥ä¸€æ­¥å€’æ¨ä¸Šå»ï¼ŒçŸ¥é“ä¸»<code>module</code>,å¤šä¸º<code>app module</code>ã€‚</p>
<pre><code>    buildTypes {
        release {
            consumerProguardFiles 'proguard-project.txt'
        }
    }
</code></pre>
<p>ç„¶è€Œï¼Œæˆ‘ç¢°åˆ°çš„æƒ…å†µåˆ™æ˜¯ï¼Œå¤šä¸ª<code>module</code>ä¸­æœ‰ç›¸åŒçš„åŒ…åï¼Œè¿™æ—¶å€™è§†å›¾å»æ¯ä¸ª<code>module</code>è‡ªé¡¾è‡ªæ··æ·†çš„æƒ…å†µä¸‹æ˜¯ä¸å¯èƒ½ã€‚å› ä¸ºåŒåŒ…åçš„æƒ…å†µä¸‹ï¼Œæ··æ·†å™¨æ˜¯æ— æ³•ä¸€ä¸ªä¸€ä¸ª<code>module</code>çš„è¿›è¡Œæ··æ·†ã€‚</p>
<p>æ‰€ä»¥æœ€ç»ˆçš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼Œé¢å¯¹è¿™ç§é¡¹ç›®ï¼Œè¿˜æ˜¯åœ¨ä¸»<code>module</code>ä¸­è¿›è¡Œæ··æ·†å§ã€‚</p>
<h5 id="åå°„çš„å¤„ç†">åå°„çš„å¤„ç†</h5>
<p>åå°„ä¸¾ä¸ªä¾‹å­ï¼š</p>
<pre><code>    Class&lt;?&gt; a = Class.forName(&quot;com.dove.xu.a&quot;);
    -keep class com.dove.xu.a{*;}    
</code></pre>
<p>ä¸è¿‡ï¼Œæ­¤å¤„åœ¨è€ƒè™‘åˆ°è‡ªå·±ä»£ç çš„åŒæ—¶ï¼Œéœ€è¦æ³¨æ„ç¬¬ä¸‰æ–¹ç±»åº“ã€‚ç±»ä¼¼çš„<code>json</code>å¤„ç†åº“ï¼Œ<code>retrofit</code>ç­‰éƒ½æ˜¯æœ‰åå°„ä»£ç çš„ã€‚</p>
<h5 id="javascript-çš„å¤„ç†">JavaScript çš„å¤„ç†</h5>
<p>å¤„ç†æ–¹æ¡ˆå’Œä¸Šé¢çš„åå°„ç±»ä¼¼</p>
<p>keep æ‰éœ€è¦è°ƒç”¨ java ä»£ç æ–¹æ³•ï¼Œæˆ–è€…ç±»å³å¯</p>
<p>ä¸¾ä¸ªæ —å­ï¼š</p>
<pre><code>    public class  WebInterface{
        WebInterface(){
        }    

        @JavascriptInterface
        public void callBackAndroid(){
            Toast.make....
        }
    }
</code></pre>
<p>æ··æ·†è§„åˆ™åªéœ€è¦åŠ ä¸Š</p>
<pre><code>    -keep class com.dove.xu.WebInterface{*;}
</code></pre>
<h5 id="å¸¸ç”¨ç³»ç»Ÿå’Œç¬¬ä¸‰æ–¹åº“çš„æ··æ·†è§„åˆ™">å¸¸ç”¨ç³»ç»Ÿå’Œç¬¬ä¸‰æ–¹åº“çš„æ··æ·†è§„åˆ™</h5>
<p>ä¸‹é¢è¿™ä¸ªgithubåº“æ”¶è—äº†å¤§é‡ç¬¬ä¸‰æ–¹åº“çš„æ··æ·†è§„åˆ™ï¼Œå¯ä»¥å»çœ‹ä¸€ä¸‹</p>
<p><a href="https://github.com/krschultz/android-proguard-snippets">snippets</a></p>
<p>åŸºæœ¬çš„ç³»ç»Ÿæ··æ·†è§„åˆ™ï¼Œåœ¨ä¸€å¼€å§‹åˆ™æ•´ä½“æµç¨‹ä¸­ä¹Ÿå·²è®°å½•ï¼Œå°±ä¸é‡å¤äº†ã€‚</p>
<p>æœ€åï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ç½‘ä¸Šä¹Ÿä¼šæœ‰å¤§é‡ç°æˆçš„ç¬¬ä¸‰æ–¹ç±»åº“çš„æ··æ·†è§„åˆ™ã€‚ä½†æ˜¯åœ¨æŠ„çš„æ—¶å€™ä¹Ÿéœ€è¦æ³¨æ„ï¼Œä¸åŒçš„ç‰ˆæœ¬æ··æ·†è§„åˆ™ä¸ä¸€å®šç›¸åŒï¼Œæ‰€ä»¥ä¸€å®šè¦æ³¨æ„ï¼Œåœ¨æ‹·è´å®Œä»¥åï¼Œçœ‹ä¸€ä¸‹è§„åˆ™ï¼Œæ˜¯å¦ç¬¦åˆè‡ªå·±çš„ç‰ˆæœ¬ï¼ŒåŒ…åæ˜¯å¦æ­£ç¡®ã€‚</p>
<p>ä¸¾ä¸ªè‡ªå·±ç¢°åˆ°çš„ä¾‹å­ï¼š</p>
<p><a href="https://github.com/JakeWharton/butterknife/blob/master/butterknife/proguard-rules.txt">Butterknife 8.2.1 æ··æ·†è§„åˆ™,æ‘˜è‡ªå®˜æ–¹github</a></p>
<pre><code>    # Retain generated class which implement ViewBinder.
    -keep public class * implements butterknife.internal.ViewBinder { public &lt;init&gt;(); }

    # Prevent obfuscation of types which use ButterKnife annotations since the simple name
    # is used to reflectively look up the generated ViewBinder.
    -keep class butterknife.*
    -keepclasseswithmembernames class * { @butterknife.* &lt;methods&gt;; }
    -keepclasseswithmembernames class * { @butterknife.* &lt;fields&gt;; }
</code></pre>
<p><a href="https://github.com/chalup/proguard-please-repo/blob/master/com.jakewharton/butterknife/5.1.2/proguard.cfg">Butterknife 5.1.2 æ··æ·†è§„åˆ™ï¼Œæ‘˜è‡ªå®˜æ–¹github</a></p>
<pre><code>    -dontwarn butterknife.internal.**
    -keep class **$$ViewInjector { *; }
    -keepnames class * { @butterknife.InjectView *;}
</code></pre>
<p>æ³¨:æ­¤å¤„å› å­¦é•¿æåˆ°<code>@</code>çš„é—®é¢˜ï¼Œåæ¥æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼Œå¦‚ä¸‹:</p>
<p>The @ specifications can be used to restrict classes and class members to the ones that are annotated with the specified annotation types. An annotationtype is specified just like a classname.</p>
<p>ä¸Šé¢å¤§æ¦‚çš„æ„æ€å°±æ˜¯è¯´ï¼Œ@ç¬¦å·å¯ä»¥ç”¨æ¥æ ‡è®°æ³¨è§£ç±»ï¼Œç”¨æ³•å’Œä¸€èˆ¬ç±»ä¸€æ ·</p>
<p>å³ï¼Œ</p>
<pre><code>-keepnames class * { @butterknife.InjectView *;}
</code></pre>
<p>æ­¤å¤„çš„æ„æ€æ˜¯ï¼Œé¿å¼€æ‰€æœ‰ç±»ä¸­ï¼Œæœ‰<code>butterknife.InjectView</code>æ³¨è§£çš„ä»»ä½•å˜é‡ï¼Œæ–¹æ³•ç­‰ï¼Œå…¶ä¸­<code>butterknife</code>æ˜¯æŒ‡åŒ…åï¼Œå³<code>InjectView</code>çš„å®Œæ•´å¼•ç”¨ï¼Œå‚è€ƒä¸‹å›¾ï¼š</p>
<figure data-type="image" tabindex="4"><img src="https://flyer88.github.io/post-images/1592214617147.jpg" alt="img" loading="lazy"></figure>
<h5 id="keep-æ³¨è§£æ¥é¿å¼€æ··æ·†">@keep æ³¨è§£æ¥é¿å¼€æ··æ·†</h5>
<pre><code>//é˜²æ­¢æ··æ·†ç±»
@Keep
public class Person {}

//é˜²æ­¢æ··æ·†å˜é‡
@Keep
public String name;

//é˜²æ­¢æ··æ·†æ–¹æ³•
@Keep
public int getAge(){}
</code></pre>
<p>éœ€è¦æ‰‹åŠ¨å¼€å¯æ³¨è§£é¿å¼€æ··æ·†</p>
<pre><code>#http://tools.android.com/tech-docs/support-    annotations
-dontskipnonpubliclibraryclassmembers
-printconfiguration
-keep,allowobfuscation @interface         android.support.annotation.Keep

-keep @android.support.annotation.Keep class *
-keepclassmembers class * {
    @android.support.annotation.Keep *;
}
</code></pre>
<hr>
<p>ä»¥ä¸Šå°±æ˜¯æˆ‘åœ¨Androidæ··æ·†æ—¶ï¼Œå­¦åˆ°çš„çŸ¥è¯†ä»¥åŠç¢°åˆ°çš„é—®é¢˜ã€‚ç‰¹æ­¤è®°å½•</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ã€æ—§ã€‘Android ä»£ç æ··æ·†(ä¸€)]]></title>
        <id>https://flyer88.github.io/post/jiu-android-dai-ma-hun-yao-yi/</id>
        <link href="https://flyer88.github.io/post/jiu-android-dai-ma-hun-yao-yi/">
        </link>
        <updated>2020-06-15T09:46:17.000Z</updated>
        <content type="html"><![CDATA[<blockquote>
<p>å†™äº 2016 å¹´ 08 æœˆ 13 æ—¥</p>
</blockquote>
<ul>
<li>ä»‹ç»
<ul>
<li>
<ul>
<li>åå°„(è¯¥éƒ¨åˆ†å†…å®¹å…·ä½“å¤„ç†å’Œç†è§£ï¼Œä¼šåœ¨ä¸‹ä¸€æ–‡ç« ä¸­è¿›è¡Œå…·ä½“çš„è®°å½•)</li>
</ul>
</li>
</ul>
</li>
<li>å…·ä½“çš„ä½¿ç”¨
<ul>
<li>
<ul>
<li>Obfuse æ­¥éª¤éªŒè¯</li>
<li>Optimize æ­¥éª¤éªŒè¯</li>
<li>Shrink æ­¥éª¤éªŒè¯</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>æœ¬æ–‡å¯¹ç…§ <a href="http://proguard.sourceforge.net/">Proguard çš„æ–‡æ¡£</a>è¿›è¡Œç¿»è¯‘åŒæ—¶åŠ ä¸Šä¸ªäººçš„ç†è§£ï¼Œå¦‚æœæœ‰ä¸åŸæ–‡ä¸åŒï¼Œè¯·ä»¥åŸæ–‡ä¸ºä¸»ã€‚</p>
<hr>
<h2 id="ä»‹ç»">ä»‹ç»</h2>
<p>æ··æ·†å™¨(ProGuard)ä¼šå¯¹ Java class æ–‡ä»¶è¿›è¡Œ shrinker(å‹ç¼©)ï¼Œoptimizer(ä¼˜åŒ–)ï¼Œobfuscator(æ··æ·†)ä»¥åŠpreverifier(æ ¡éªŒ)ã€‚shrinker(å‹ç¼©)è¿™ä¸€æ­¥ä¼šæ‰¾åˆ°å¹¶ç§»é™¤æ²¡ç”¨åˆ°çš„ç±»ï¼Œå˜é‡ï¼Œæ–¹æ³•ï¼Œå±æ€§ã€‚optimization(ä¼˜åŒ–)è¿™ä¸€æ­¥ï¼Œä¼šåˆ†æå¹¶ä¸”ä¼˜åŒ–æ–¹æ³•çš„å­—èŠ‚ç ã€‚obfuscation(æ··æ·†)åˆ™ä¼šå¯¹ classï¼Œfieldsï¼Œmethodsæ›¿æ¢æˆä¸€äº›çŸ­çš„æ— æ„ä¹‰çš„åå­—ã€‚ç¬¬ä¸€æ­¥ä¼šæŠŠä»£ç é‡å˜å°ï¼Œè¿è¡Œæ›´åŠ æœ‰æ•ˆç‡ï¼ŒåŒæ—¶æ›´åŠ éš¾ä»¥è¢«é€†å‘ã€‚åœ¨ Java Micro Edition å’Œ Java 6æˆ–è€…æ›´é«˜ç‰ˆæœ¬ä¸­ï¼Œæœ€åä¸€æ­¥çš„æ£€éªŒè¿‡ç¨‹ï¼Œä¼šå‘classæ–‡ä»¶ä¸­æ·»åŠ ä¸€äº›é¢„æ ¡éªŒçš„ä¿¡æ¯ã€‚</p>
<p>ä¸Šè¿°çš„æ¯ä¸ªæ­¥éª¤ï¼Œéƒ½æ˜¯å¯ä»¥é€‰æ‹©çš„(å¯ä»¥è¿›è¡Œä¹Ÿå¯ä»¥ä¸è¿›è¡Œ)ã€‚ä¾‹å¦‚ï¼ŒProGuard å¯ä»¥åªè¿›è¡Œpreverifyï¼Œä»è€Œæ›´é«˜æ•ˆçš„è¿è¡Œã€‚</p>
<figure data-type="image" tabindex="1"><img src="https://flyer88.github.io/post-images/1592214415502.jpg" alt="img" loading="lazy"></figure>
<ul>
<li>é¦–å…ˆï¼ŒProGuard(æ··æ·†å™¨) è¯»å…¥è¾“å…¥çš„ jars (ä¹Ÿå¯ä»¥æ˜¯ aars, wars, ears, zips, apks, æˆ–è€…ç›®å½•)ã€‚éšåï¼Œå¼€å§‹è¿›è¡Œ shrinker(å‹ç¼©)ï¼Œoptimizer(ä¼˜åŒ–)ï¼Œobfuscator(æ··æ·†)ä»¥åŠpreverifier(æ ¡éªŒ)ã€‚ä½ å¯ä»¥é€‰æ‹©æ€§çš„è®©ProGuard(æ··æ·†å™¨)è¿›è¡Œå¤šç§ç±»å‹çš„ä¼˜åŒ–æ“ä½œã€‚ProGuard(æ··æ·†å™¨)ä¼šæŠŠä¿®æ”¹è¿‡çš„ç»“æœå†™å…¥ä¸€ä¸ªæˆ–è€…å¤šä¸ªè¾“å‡ºçš„ jars (ä¹Ÿå¯ä»¥æ˜¯ aars, wars, ears, zips, apks, æˆ–è€…ç›®å½•)ä¸­ã€‚</li>
<li>æ··æ·†å™¨éœ€è¦æ˜ç¡®è¾“å…¥æ–‡ä»¶(Input jars)æ˜¯jarsåŒ…(ä¹Ÿå¯ä»¥æ˜¯ aars, wars, ears, zips, apks, æˆ–è€…ç›®å½•)ã€‚è¿™äº› libraries æœ¬è´¨ä¸Šæ˜¯ä½ å°†ä¼šç”¨æ¥ç¼–è¯‘çš„ä»£ç ã€‚æ··æ·†å™¨ä¸ºäº†èƒ½å¤Ÿæ­£ç¡®è¿›è¡Œæ•´ä¸ªè¿‡ç¨‹ï¼Œä¼šé‡æ–°æ„å»ºç±»ä¹‹é—´çš„ä¾èµ–ã€‚è€Œä¾èµ–åŒ…(Library jars) å¾€å¾€æ˜¯ä¸ä¼šè¢«æ”¹å˜çš„ï¼Œä½†ä½ ä¾æ—§éœ€è¦æŠŠå®ƒä»¬æ”¾åœ¨æœ€ç»ˆçš„Appçš„ç¯å¢ƒä¸­ã€‚ #### Entry points(å…¥å£ç‚¹)</li>
<li>åœ¨å‹ç¼©æ­¥éª¤(shrinker)ï¼Œæ··æ·†å™¨ä¼šä»è¿™äº›ç‚¹(å…¥å£ç‚¹)è¿›å…¥ï¼Œå¹¶ä¸”é€’å½’å¯»æ‰¾å†³å®šå“ªäº›ç±»å’Œå“ªäº›ç±»æˆå‘˜ä¼šè¢«ä½¿ç”¨ã€‚æ‰€æœ‰çš„å…¶ä»–ç±»å’Œç±»æˆå‘˜éƒ½ä¼šè¢«æŠ›å¼ƒæ‰</li>
<li>åœ¨ä¼˜åŒ–æ­¥éª¤(optimizer)ï¼Œæ··æ·†å™¨ä¼šè¿›ä¸€æ­¥ä¼˜åŒ–ä»£ç ã€‚åœ¨è¿™äº›ä¼˜åŒ–è¿‡ç¨‹ä¸­ï¼Œé‚£äº›ä¸æ˜¯å…¥å£ç‚¹çš„ç±»å’Œæ–¹æ³•ä¼šå˜æˆprivate staticæˆ–è€…finalï¼Œä¸è¢«ç”¨åˆ°çš„å‚æ•°ä¼šè¢«ç§»é™¤ï¼Œä¸€äº›æ–¹æ³•ä¼šå˜æˆå†…æ•›æ–¹æ³•</li>
<li>åœ¨æ··æ·†è¿™ä¸€æ­¥(obfuscator)ï¼Œæ··æ·†å™¨ä¼šé‡æ–°å‘½åé‚£äº›ä¸æ˜¯å…¥å£ç‚¹çš„ç±»å’Œç±»çš„æˆå‘˜ã€‚åœ¨è¿™æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œé‚£äº›æˆä¸ºå…¥å£ç‚¹çš„åœ°æ–¹ï¼Œä¾æ—§ä¼šä¸ºä»–ä»¬ä¿ç•™åŸæ¥çš„åå­—</li>
<li>é¢„éªŒè¯é˜¶æ®µ(preverifier)æ˜¯å”¯ä¸€ä¸€ä¸ªä¸éœ€è¦çŸ¥é“å…¥å£ç‚¹çš„é˜¶æ®µ</li>
</ul>
<h4 id="åå°„è¯¥éƒ¨åˆ†å†…å®¹å…·ä½“å¤„ç†å’Œç†è§£ä¼šåœ¨ä¸‹ä¸€æ–‡ç« ä¸­è¿›è¡Œå…·ä½“çš„è®°å½•">åå°„(è¯¥éƒ¨åˆ†å†…å®¹å…·ä½“å¤„ç†å’Œç†è§£ï¼Œä¼šåœ¨ä¸‹ä¸€æ–‡ç« ä¸­è¿›è¡Œå…·ä½“çš„è®°å½•)</h4>
<ul>
<li>å¯¹äºåå°„å’Œintrospection è¿›è¡Œä»£ç çš„è‡ªåŠ¨å¤„ç†æ—¶ï¼Œéƒ½ä¼šå­˜åœ¨ä¸€äº›ç‰¹æ®Šçš„é—®é¢˜ã€‚åœ¨æ··æ·†å™¨è¿›è¡Œå¤„ç†æ—¶ï¼Œä»£ç ä¸­ç±»å’Œç±»æˆå‘˜éƒ½æ˜¯è¢«åŠ¨æ€åˆ›å»ºæˆ–è€…è¢«åŠ¨æ€è°ƒç”¨çš„(é€šè¿‡å¯¹åº”ç±»çš„åå­—ï¼Œæˆ–è€…æˆå‘˜åå­—)ï¼Œè¿™äº›åœ°æ–¹éƒ½å¿…é¡»è¢«å®šä¹‰æˆå…¥å£ç‚¹ã€‚ä¾‹å¦‚ï¼Œ<code>Class.forName()</code>è¿™ä¸ªæ„é€ å™¨ä¼šåœ¨è¿è¡Œæ—¶æŒ‡å‘ä»»ä½•çš„ç±»ã€‚åˆæ¯”å¦‚ï¼Œç±»çš„åå­—å¯èƒ½ä¼šä»é…ç½®æ–‡ä»¶ä¸­è¯»å…¥ï¼Œè¿™é€šå¸¸å¾ˆéš¾å»è®¡ç®—å‡ºæ˜¯é‚£äº›ç±»éœ€è¦è¢«ä¿ç•™(é€šè¿‡åŸå§‹çš„åå­—)ã€‚å› æ­¤ï¼Œä½ å¿…é¡»å¾—åœ¨æ··æ·†å™¨çš„é…ç½®ä¸­ï¼Œé€šè¿‡ç®€å•ç›¸åŒçš„æ“ä½œ<code>-keep</code>æ¥æŒ‡å®šä»–ä»¬ã€‚ ç„¶è€Œï¼Œæ··æ·†å™¨å·²ç»èƒ½å¤Ÿå¸®ä½ å‘ç°å¹¶å¤„ç†ä»¥ä¸‹çš„æƒ…å†µï¼š <code>Class.forName(&quot;SomeClass&quot;)</code> <code>SomeClass.class</code> <code>SomeClass.class.getField(&quot;someField&quot;)</code> <code>SomeClass.class.getDeclaredField(&quot;someField&quot;)</code> <code>SomeClass.class.getMethod(&quot;someMethod&quot;, new Class[] {})</code> <code>SomeClass.class.getMethod(&quot;someMethod&quot;, new Class[] { A.class })</code> <code>SomeClass.class.getMethod(&quot;someMethod&quot;, new Class[] { A.class, B.class })</code> <code>SomeClass.class.getDeclaredMethod(&quot;someMethod&quot;, new Class[] {})</code> <code>SomeClass.class.getDeclaredMethod(&quot;someMethod&quot;, new Class[] { A.class })</code> <code>SomeClass.class.getDeclaredMethod(&quot;someMethod&quot;, new Class[] { A.class, B.class })</code> <code>AtomicIntegerFieldUpdater.newUpdater(SomeClass.class, &quot;someField&quot;)</code> <code>AtomicLongFieldUpdater.newUpdater(SomeClass.class, &quot;someField&quot;)</code> <code>AtomicReferenceFieldUpdater.newUpdater(SomeClass.class, SomeType.class, &quot;someField&quot;)</code></li>
<li>ç±»å’Œç±»æˆå‘˜çš„åå­—ä¼šä¸ä¸€æ ·ï¼Œä½†æ˜¯æ„é€ æ–¹æ³•å¿…ç„¶æ˜¯ç›¸åŒçš„ï¼Œç”±æ­¤ï¼Œæ··æ·†å™¨èƒ½å¤Ÿè®¤å‡ºä»–ä»¬ã€‚è¢«å¼•ç”¨çš„ç±»å’Œç±»çš„æˆå‘˜åœ¨å‹ç¼©(shrinking)é˜¶æ®µä¼šè¢«ä¿ç•™ï¼ŒåŒæ—¶ï¼Œstring ç±»å‹çš„å‚æ•°ä¹Ÿä¼šåœ¨æ··æ·†æ—¶(obfuscation)è¢«å‡†ç¡®çš„ä¿®æ”¹ã€‚</li>
<li>é™¤æ­¤ä¹‹å¤–ï¼Œæ··æ·†å™¨ä¼šæä¾›ä¸€äº›å»ºè®®ï¼šæ˜¯å¦ä¿ç•™ä¸€äº›å‡ºç°çš„ç±»å’Œç±»æˆå‘˜ã€‚ä¸¾ä¾‹ï¼Œæ··æ·†å™¨ä¼šæ ‡è®°<code>(SomeClass)Class.forName(variable).newInstance()</code>è¿™æ ·çš„æ„é€ å™¨ã€‚å› ä¸ºè¿™äº›æ–¹æ³•å¯èƒ½ä¼šæŒ‡å‘å…¶ä»–ç±»ï¼Œè¿™äº›å¯èƒ½æ˜¯ç±»ï¼Œä¹Ÿå¯èƒ½æ˜¯æ¥å£ï¼Œæˆ–è€…æ˜¯ç»§æ‰¿è‡ªè¿™äº›æ¥å£æˆ–è€…ç±»çš„ç±»ã€‚ä½ éœ€è¦åœ¨é…ç½®ä¸­åšç›¸åº”çš„å¤„ç†ã€‚</li>
<li>ä¸ºäº†èƒ½å¤Ÿå¾—åˆ°æ­£ç¡®çš„æ··æ·†ç»“æœï¼Œä½ åº”è¯¥å¯¹è¿›è¡Œæ··æ·†çš„ä»£ç å¤šå°‘æœ‰æ‰€ç†Ÿæ‚‰ã€‚å½“é¢ä¸´å¤§é‡åå°„ä»£ç æ—¶ï¼Œæ··æ·†ä»£ç éœ€è¦è¿›è¡Œå¤§é‡çš„è¯•éªŒï¼Œå¹¶å¤„ç†é”™è¯¯ï¼Œç‰¹åˆ«æ˜¯å¯¹äºå†…éƒ¨ä»£ç æ²¡æœ‰è¶³å¤Ÿçš„ä¿¡æ¯çš„æƒ…å†µä¸‹</li>
</ul>
<hr>
<p>ä»¥ä¸Šæ˜¯å¯¹<a href="http://proguard.sourceforge.net/">å®˜æ–¹æ–‡æ¡£é¦–é¡µ</a>çš„ç¿»è¯‘å†…å®¹</p>
<h2 id="å…·ä½“çš„ä½¿ç”¨">å…·ä½“çš„ä½¿ç”¨</h2>
<p>è¯¥éƒ¨åˆ†ä¸æ˜¯ç¿»è¯‘å†…å®¹ï¼Œæ˜¯æ ¹æ®<a href="http://proguard.sourceforge.net/manual/usage.html">ProGuard çš„ä½¿ç”¨æ–¹æ³•</a>å’Œ<a href="http://proguard.sourceforge.net/">æ–‡æ¡£é¦–é¡µ</a>ï¼Œå¯¹ä¸Šè¿°ä¸‰ä¸ªæ­¥éª¤çš„å…·ä½“éªŒè¯ã€‚</p>
<p>ç”±äºå¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼ŒAndroid çš„æ··æ·†åªéœ€è¦è€ƒè™‘ Obfuse è¿™ä¸ªæ­¥éª¤ï¼Œå› ä¸ºå¾ˆå¤šç¬¬ä¸‰æ–¹ä¾èµ–åŒ…çš„æ··æ·†è§„åˆ™ä¼šæŠŠ shrink å’Œ optimize å»æ‰ï¼ˆæ¯”å¦‚å‹ç›Ÿï¼‰ã€‚æ‰€ä»¥å…ˆéªŒè¯è¿™ä¸€æ­¥ã€‚</p>
<h4 id="obfuse-æ­¥éª¤éªŒè¯">Obfuse æ­¥éª¤éªŒè¯</h4>
<p>è¿™ä¸ªæ­¥éª¤ï¼Œå¦‚ä¸Šæ‰€è¯´ï¼Œä¸»è¦æ˜¯å¯¹ç±»ï¼Œæ–¹æ³•è¿›è¡Œåå­—çš„ä¿®æ”¹ï¼Œä¹Ÿæ˜¯ Android æ··æ·†ä¸­æœ€é‡è¦çš„éƒ¨åˆ†ã€‚ä¸ºäº†éªŒè¯è¿™ä¸ªè¿‡ç¨‹ï¼Œæˆ‘åšäº†ä¸‹é¢çš„demoæ“ä½œ</p>
<ul>
<li>é¦–å…ˆå†™äº†3ä¸ªç±»ï¼š</li>
</ul>
<pre><code>    package com.dove.home;

    class HelloWorld {
        public HelloWorld(){
            System.out.println(&quot;Hello World&quot;);
        }
    }
    package com.dove.home;

    class HelloWorld2 {
        public HelloWorld2(){
            System.out.println(&quot;Hello World2&quot;);
        }
    }
    package com.dove.home;

    class Main {
        public static void main(String[] args) {
            HelloWorld helloWorld = new HelloWorld();
        }
    }
</code></pre>
<ul>
<li>ç„¶åç¼–è¯‘,æ‰“åŒ…</li>
</ul>
<pre><code>    javac com/dove/home/Main.java
    javac com/dove/home/HelloWorld2.java
    javac com/dove/home/HelloWorld.java
    //æ³¨æ„åœ¨è¿›è¡Œä¸‹é¢æ­¥éª¤çš„æ—¶å€™ï¼Œæˆ‘æŠŠ com/dove/home ä¸‹çš„ javaæºç åˆ äº†
    jar -cvf main_source.jar com
</code></pre>
<figure data-type="image" tabindex="2"><img src="https://flyer88.github.io/post-images/1592214446516.jpg" alt="img" loading="lazy"></figure>
<ul>
<li>ç„¶åä½¿ç”¨æ··æ·†å™¨ï¼Œæ··æ·†å™¨å…¶å…·ä½“ä½¿ç”¨æ–¹æ³•ï¼Œä¸»è¦æ˜¯è°ƒç”¨ proguard.jar åŒ…ï¼Œç„¶åé…ç½® proguard.pro æ–‡ä»¶è¿›è¡Œå…·ä½“çš„å‚æ•°è®¾ç½®ã€‚</li>
</ul>
<pre><code>java -jar proguard.jar @proguard.pro
</code></pre>
<p>ä¸‹é¢æ˜¯æˆ‘ proguard.pro æ–‡ä»¶å†…å®¹</p>
<pre><code># æºç æ–‡ä»¶
-injars main_source.jar
# æ··æ·†åè¾“å‡ºæ–‡ä»¶
-outjars main_source_out.jar
# java æ ¸å¿ƒ jar ä¸èƒ½æ··æ·†
-libraryjars &lt;java.home&gt;/lib/rt.jar
-libraryjars &lt;java.home&gt;/lib/jce.jar
# å…¨éƒ¨ä¸æ··æ·†ï¼Œå³ä¸‰ä¸ªclassæ–‡ä»¶éƒ½ä¼šä¿æŒåŸæ ·
-keep class com.dove.home.Main{*;}
-keep class com.dove.home.HelloWorld{*;}
-keep class com.dove.home.HelloWorld2{*;}
</code></pre>
<blockquote>
<p>æ³¨æ„ï¼šç„¶åä¿®æ”¹ proguard.pro æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹,ç”Ÿæˆå¦ä¸€ä¸ªæ··æ·†åçš„åŒ…</p>
</blockquote>
<pre><code>-injars main_source.jar
# æ³¨æ„è¾“å‡ºåŒ…çš„åå­—æ”¹äº†
-outjars main_source_proguard_out.jar
-libraryjars &lt;java.home&gt;/lib/rt.jar
-libraryjars &lt;java.home&gt;/lib/jce.jar
-keep class com.dove.home.Main{*;}
# åˆ é™¤äº†HelloWorldçš„ keep
-keep class com.dove.home.HelloWorld2{*;}
</code></pre>
<p>æœ€åå¯¹ä»£ç é€†å‘ï¼Œè¿›è¡ŒéªŒè¯ï¼Œæœ€å¿«çš„æ–¹å¼æ˜¯æŠŠç”Ÿæˆçš„ jar åŒ…ï¼Œå½“åšç¬¬ä¸‰æ–¹ä¾èµ–åŒ…ç›´æ¥å¯¼å…¥Intellij ä¸­(æœ‰decodeçš„åŠŸèƒ½)ï¼Œå¦‚ä¸‹å›¾ï¼Œä¸‰ä¸ªåŒ…çš„åŒºåˆ«</p>
<figure data-type="image" tabindex="3"><img src="https://flyer88.github.io/post-images/1592214471667.jpg" alt="img" loading="lazy"></figure>
<p>æœ€åˆæ˜¯çš„æºç åŒ…å’Œä¿ç•™<code>HelloWorld</code>,<code>HelloWorld2</code>ä»¥åŠ<code>Main</code>å…¥å£ç‚¹çš„åŒ…æ˜¯ä¸€æ ·çš„ï¼Œä¸åŒçš„æ˜¯æœ€åæ²¡æœ‰ä¿ç•™<code>HelloWorld</code>å…¥å£ç‚¹çš„åŒ…ï¼Œå®ƒçš„<code>HelloWorld</code>å˜æˆäº†<code>a</code>ï¼Œè€Œ<code>Main</code>å’Œ<code>HelloWorld2</code>éƒ½æ­£å¸¸æ²¡æœ‰è¢«ä¿®æ”¹</p>
<h4 id="optimize-æ­¥éª¤éªŒè¯">Optimize æ­¥éª¤éªŒè¯</h4>
<p>åŒæ ·ï¼Œä¿®æ”¹ proguard.pro æ–‡ä»¶</p>
<pre><code>-injars main_source.jar
# è¾“å‡ºåŒ…åæ”¹äº†ï¼Œæ–¹ä¾¿å¯¹æ¯”
-outjars main_source_proguard_not_optimize_out.jar
-libraryjars &lt;java.home&gt;/lib/rt.jar
-libraryjars &lt;java.home&gt;/lib/jce.jar
# åŠ ä¸Šä¸è¿›è¡Œä¼˜åŒ–çš„é™åˆ¶
-dontoptimize
-keep class com.dove.home.Main{*;}
-keep class com.dove.home.HelloWorld2{*;}
</code></pre>
<p>åŒä¸Šï¼Œå¯¼å…¥IntelliJï¼Œå¯¹æ¯”ä¸Šä¸€æ­¥ä¸­æ··æ·†åçš„ jar åŒ…ï¼Œå‘ç°åå­—æ²¡å•¥å˜åŒ–ï¼Œä½†å†…å®¹ä¸ä¸€æ ·äº†</p>
<figure data-type="image" tabindex="4"><img src="https://flyer88.github.io/post-images/1592214485831.jpg" alt="img" loading="lazy"></figure>
<p>é¦–å…ˆæ˜¯æ²¡æœ‰æ·»åŠ  <code>-dontoptimize</code></p>
<pre><code>package com.dove.home;

final class a {
    public a() {
        System.out.println(&quot;Hello World&quot;);
    }
}
</code></pre>
<p>ç„¶åæ˜¯æ·»åŠ äº† <code>-dontoptimize</code></p>
<pre><code>package com.dove.home;

class a {
    public a() {
        System.out.println(&quot;Hello World&quot;);
    }
}
</code></pre>
<p>å¦‚ä¸Šè¿°è¯‘æ–‡ä¸­æ‰€è¯´ï¼Œoptimize ä¼šè¿›è¡Œä»£ç ä¼˜åŒ–ï¼Œä¸æ˜¯å…¥å£ç‚¹çš„ä»£ç ï¼Œä¼šå˜æˆ<code>final</code>ï¼Œ<code>private</code>ç­‰ç­‰</p>
<h4 id="shrink-æ­¥éª¤éªŒè¯">Shrink æ­¥éª¤éªŒè¯</h4>
<p>ä¿®æ”¹ proguard.pro æ–‡ä»¶ï¼Œè¿›è¡Œå‹ç¼©ï¼ŒåŒæ—¶ä¸å¯¹ HelloWorldï¼ŒHelloWorld2è¿›è¡Œå…¥å£ç‚¹çš„ä¿ç•™</p>
<pre><code>-injars main_source.jar
-outjars main_source_proguard_shrink_out.jar
-libraryjars &lt;java.home&gt;/lib/rt.jar
-libraryjars &lt;java.home&gt;/lib/jce.jar

-keep class com.dove.home.Main{*;}
# æ³¨æ„å¯¹æ¯”ä¹‹å‰ï¼Œåˆ é™¤äº†HelloWorldå’ŒHelloWorld2çš„ keep
</code></pre>
<p>ä¿®æ”¹ proguard.pro æ–‡ä»¶ï¼Œä¸è¿›è¡Œå‹ç¼©ï¼ŒåŒæ ·ä¸å¯¹ HelloWorldï¼ŒHelloWorld2è¿›è¡Œå…¥å£ç‚¹çš„ä¿ç•™</p>
<pre><code>-injars main_source.jar
-outjars main_source_proguard_not_shrink_out.jar
-libraryjars &lt;java.home&gt;/lib/rt.jar
-libraryjars &lt;java.home&gt;/lib/jce.jar
# æ·»åŠ ä¸è¿›è¡Œå‹ç¼©
-dontshrink
-keep class com.dove.home.Main{*;}
</code></pre>
<p>å…¶ç»“æœå¯¹æ¯”</p>
<p>æ·»åŠ äº† <code>-dontshrink</code>æ ‡å¿—</p>
<figure data-type="image" tabindex="5"><img src="https://flyer88.github.io/post-images/1592214500132.jpg" alt="img" loading="lazy"></figure>
<p>æœªæ·»åŠ  <code>-dontshrink</code>æ ‡å¿—</p>
<figure data-type="image" tabindex="6"><img src="https://flyer88.github.io/post-images/1592214511632.jpg" alt="img" loading="lazy"></figure>
<p>ç”±æ­¤éªŒè¯ï¼Œshrinké˜¶æ®µï¼ŒProguard(æ··æ·†å™¨)ä¼šæŠŠæ— ç”¨ç±»æ–‡ä»¶ç­‰åˆ é™¤ï¼Œä¸€äº›è¢«åŠ¨æ€è·å–çš„ç±»å°±éœ€è¦æ³¨æ„äº†ï¼Œéœ€è¦è¿›è¡Œ<code>-keep</code>æ“ä½œ</p>
<hr>
<p>ä»¥ä¸Šå°±æ˜¯å¯¹æ··æ·†æ•´ä¸ªè¿‡ç¨‹çš„éªŒè¯</p>
<p>å¯¹äº Android æ··æ·†ï¼Œä¸€äº›éœ€è¦æ³¨æ„çš„ä¸œè¥¿ï¼Œä¼šåœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­è®°å½•</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ã€æ—§ã€‘è®°å½•ä¸€äº›è›‹ç–¼çš„bug(äºŒ)]]></title>
        <id>https://flyer88.github.io/post/jiu-ji-lu-yi-xie-dan-teng-de-buger/</id>
        <link href="https://flyer88.github.io/post/jiu-ji-lu-yi-xie-dan-teng-de-buger/">
        </link>
        <updated>2020-06-15T09:45:36.000Z</updated>
        <content type="html"><![CDATA[<blockquote>
<p>å†™äº 2016 å¹´ 07 æœˆ 15 æ—¥</p>
</blockquote>
<p>1.<code>int</code> -2^32 åˆ° 2^32ï¼Œ<code>long</code> -2^63 åˆ° 2^63-1ï¼Œè¿™ç§é—®é¢˜å¤§éƒ¨åˆ†åœ¨æ—¶é—´æˆ³ç¢°åˆ°ï¼Œéœ€æ³¨æ„</p>
<pre><code class="language-java">public static void main(String[] args) {
    int time = 1470022057;//æ³¨æ„æ˜¯intç±»å‹
    System.out.println(formatLongToDate(time));//ä¼ å…¥çš„æ˜¯intï¼Œå‚æ•°æ˜¯longä¸ä¼šè¶…å‡ºinté•¿åº¦
    System.out.println(format(new Date(time * 1000),&quot;MMæœˆddæ—¥ HH:mm&quot;));//ä¼ å…¥çš„æ˜¯intï¼Œç§’çº§æ—¶é—´æˆ³ï¼Œä½æ•°åˆšå¥½å’Œintç±»å‹çš„ä½æ•°ç›¸åŒï¼Œæ‰€ä»¥ä¼šçˆ†ï¼Œæ‰€ä»¥è½¬æ¢ä¼šå‡ºé”™
} 
public static String formatLongToDate(long time){
    SimpleDateFormat sdf = new SimpleDateFormat(&quot;MMæœˆddæ—¥ HH:mm&quot;);
    Date date= new Date(time * 1000);
    String result = sdf.format(date);
    return result;
}
public static String format(Date date, String regex) {
    DateFormat df = new SimpleDateFormat(regex);
    return df.format(date);
}
</code></pre>
<p>ä¸Šè¿°è¿è¡Œç»“æœ</p>
<pre><code>08æœˆ01æ—¥ 11:27
01æœˆ14æ—¥ 13:34
</code></pre>
<ol>
<li>å…³äº<code>targetSdkVersion</code>(<a href="http://gold.xitu.io/entry/5690e33460b20f9aeaa3f085/view">å‡ ä¸ªcodeçš„åŒºåˆ«</a>)é™çº§é—®é¢˜ï¼Œé™çº§ä¼šå¸¦æ¥å¾ˆå¤šæœªçŸ¥é—®é¢˜ã€‚ç”¨æˆ·å®‰è£…äº†<code>targetSdkVersion</code>æ˜¯<code>23</code>ç‰ˆæœ¬çš„<code>app</code>ï¼Œè€Œä¸‹ä¸€ä¸ªç‰ˆæœ¬æŠŠ<code>targetSdkVersion</code>æ”¹ä¸ºäº†<code>22</code>ï¼Œé¦–å…ˆï¼Œç¬¬ä¸€ä¸ªé—®é¢˜å°±æ˜¯ä¼šå¯¼è‡´ç”¨æˆ·æ— æ³•å®‰è£…ï¼Œéœ€è¦å¸è½½åé‡è£…ã€‚åˆæ¬¡ä¹‹å¤–ï¼Œé™çº§ä¹Ÿä¼šå¯¼è‡´å¯¹ä¸€äº›<code>API</code>è°ƒç”¨ä¸æ­£å¸¸ã€‚</li>
<li>åŒæ—¶ä¿®æ”¹äº†å¤šä¸ª<code>module</code>çš„<code>gradle</code>æ–‡ä»¶ï¼Œå‡ºç°äº†ä»¥ä¸‹é—®é¢˜<code>Error:Timeout waiting to lock cp_proj class cache for</code>åˆ é™¤æŠ¥é”™çš„cacheæ–‡ä»¶å¤¹å³å¯</li>
</ol>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ã€æ—§ã€‘è®°å½•ä¸€äº›è›‹ç–¼çš„bug(ä¸€)]]></title>
        <id>https://flyer88.github.io/post/jiu-ji-lu-yi-xie-dan-teng-de-bugyi/</id>
        <link href="https://flyer88.github.io/post/jiu-ji-lu-yi-xie-dan-teng-de-bugyi/">
        </link>
        <updated>2020-06-15T09:45:03.000Z</updated>
        <content type="html"><![CDATA[<blockquote>
<p>å†™äº 2015å¹´ 12 æœˆ 21 æ—¥</p>
</blockquote>
<ol>
<li>
<p>ä¸»é¢˜é€‚é…æ—¶ï¼Œdrawable é”™è¯¯ ...... Caused by: android.content.res.Resources$NotFoundException: File res/drawable/menu_shape.xml from drawable resource ID #0x7f020179 ...... Caused by: java.lang.UnsupportedOperationException: Can't convert to color: type=0x2</p>
<p>drawable ä¸­ å¯¹ attr color è¿›è¡Œå¼•ç”¨å¯¼è‡´æŠ¥é”™</p>
<p>å…·ä½“çœ‹ https://code.google.com/p/android/issues/detail?id=26251</p>
<p>Android ç³»ç»Ÿ çš„ bugï¼Œcolor æ— æ³•è¢«å¼•ç”¨åˆ°drawableä¸­ï¼Œåªèƒ½ä¸€ä¸ªä¸»é¢˜ä¸€ä¸ªdrawableï¼Œ5.0ä»¥ä¸Šä¿®å¤æ­¤bug</p>
</li>
<li>
<p>ç›¸å†Œé—®é¢˜</p>
<p>ä¸åŒç‰ˆæœ¬ä¸‹ï¼Œç³»ç»Ÿç›¸å†Œçš„ä½ç½®æ˜¯ä¸åŒçš„ï¼Œå»ºè®®åˆ›å»ºä¸€ä¸ªè‡ªå·±çš„æ–‡ä»¶å¤¹ï¼Œå…·ä½“æ“ä½œï¼Œé€šè¿‡<code>Environement.get..</code>æ¥è·å–ç³»ç»Ÿç¯å¢ƒä¸‹çš„sdå¡ç›®å½•ï¼Œç„¶ååˆ›å»ºæ–‡ä»¶å¤¹</p>
</li>
</ol>
<pre><code>Intent intent = newIntent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE);//ç³»ç»Ÿæ‹ç…§
intent.putExtra(MediaStore.EXTRA_VIDEO_QUALITY, 1);//ç”»è´¨
intent.putExtra(MediaStore.EXTRA_OUTPUT, uri);//ä¿å­˜åˆ°uri
Environment.getExternalStorageDirectory();//è·å–uriæ—¶ï¼Œç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä¸ç„¶å®¹æ˜“ä¸åŒç‰ˆæœ¬ä¸é—®é¢˜
</code></pre>
<ol start="3">
<li>XwalkViewï¼ˆ14ï¼‰æˆªå›¾é—®é¢˜</li>
</ol>
<p>http://stackoverflow.com/questions/29483028/how-can-i-capture-the-whole-view-into-a-bitmap-when-using-crosswalk-to-display-w</p>
<p>http://www.cnblogs.com/ct2011/p/4100132.html</p>
<p>æ³¨æ„ï¼š</p>
<ul>
<li>
<p><code>XWalkPreferences.setValue(XWalkPreferences.ANIMATABLE_XWALK_VIEW, true)</code>éœ€è¦åœ¨loadä¹‹å‰å°±è®¾ç½®,åœ¨<code>activity</code> çš„<code>onCreate()</code>è®¾ç½®ï¼Œ<code>onDestroy()</code> ä¸­å»é™¤</p>
</li>
<li>
<p>è·å–<code>TextureView</code>:</p>
<pre><code>private TextureView findXWalkTextureView(ViewGroup group) {
       int childCount = group.getChildCount();
       for (int i = 0; i &lt; childCount; i++) {
           View child = group.getChildAt(i);
        if (child instanceof TextureView) {
            String parentClassName = child.getParent().getClass().toString();
            boolean isRightKindOfParent = (parentClassName.contains(&quot;XWalk&quot;));
            if (isRightKindOfParent) {
                return (TextureView) child;
            }
        } else if (child instanceof ViewGroup) {
            TextureView textureView = findXWalkTextureView((ViewGroup) child);
            if (textureView != null) {
                return textureView;
            }
        }
    }
    return null;
}
</code></pre>
</li>
<li>
<p>æˆªå›¾ï¼š</p>
<pre><code>public Bitmap captureImage(XWalkView xWalkView) {

if (xWalkView != null) {
    Bitmap bitmap = null;

    boolean isCrosswalk = false;
    try {
        Class.forName(&quot;org.xwalk.core.XWalkView&quot;);
        isCrosswalk = true;
    } catch (Exception e) {
        e.printStackTrace();
    }

    if (isCrosswalk) {
        try {
            TextureView textureView = findXWalkTextureView(xWalkView);
            bitmap = textureView.getBitmap();
        } catch (Exception e) {
            e.printStackTrace();
        }
    } else {
        bitmap = Bitmap.createBitmap(xWalkView.getWidth(), xWalkView.getHeight(), Bitmap.Config.ARGB_8888);
        Canvas c = new Canvas(bitmap);
        xWalkView.draw(c);
    }
    return bitmap;
    } else {
        return null;
    }
    }
</code></pre>
</li>
</ul>
<ol start="4">
<li>popwindow å’Œ menuç‰©ç†é”® ç¬¬äºŒæ¬¡æ— æ³•è§¦å‘ï¼Œä»¥åŠç¬¬äºŒæ¬¡ç›´æ¥å¼¹å‡ºå¹¶ä¸”éšè—é—®é¢˜<br>
ä¸»è¦åŸå› æ˜¯ï¼Œpopwindow æ·»åŠ äº†windowä»è€Œæˆªå–äº†menuäº‹ä»¶ï¼Œæ‰€ä»¥activityå¤„æ— æ³•è·å–<br>
http://www.bkjia.com/Androidjc/988767.html<br>
Activity ä»£ç ï¼š</li>
</ol>
<pre><code>@Override
public boolean onKeyDown(int keyCode, KeyEvent event) {

    switch (keyCode) {
    case KeyEvent.KEYCODE_MENU:
        isMenuShow = true;
        showPopupWindow();
        break;
    }
    return super.onKeyDown(keyCode, event);
}
</code></pre>
<p>showPopupWindow:</p>
<pre><code>    private void showPopupWindow() {
        View view = inflater.inflate(R.layout.popupwindow, null);
        ll.setOnKeyListener(new OnKeyListener() {
            @Override
            public boolean onKey(View v, int keyCode, KeyEvent event) {
                if (keyCode == KeyEvent.KEYCODE_MENU) {
                    if (!isMenuShow) {
                        popupWindow.dismiss();
                    }
                    isMenuShow = false;
                }
                return false;
            }
        });
</code></pre>
<ol>
<li>Android appcompat-v7 å…¼å®¹åŒ…å¯¼è‡´ MENU æŒ‰é”®ä¸èƒ½ç›‘å¬åˆ°çš„è§£å†³æ–¹æ¡ˆ</li>
</ol>
<p>https://twiceyuan.com/2015/05/07/Android-appcompat-v7-å…¼å®¹åŒ…å¯¼è‡´-MENU-æŒ‰é”®ä¸èƒ½ç›‘å¬åˆ°çš„è§£å†³æ–¹æ¡ˆ/</p>
<ol>
<li>
<p>bug 5.0 ä»¥ä¸Š button ä¸­è®¾ç½® text è‹±æ–‡çŠ¶æ€ä¸‹ä¼šå˜æˆå¤§å†™<br>
è§£å†³æ–¹æ³•ï¼š<code>android:textAllCaps=&quot;false&quot;</code></p>
</li>
<li>
<p>Android 6.0ï¼ˆ23ï¼‰ æºç ä¸­ï¼ŒStringç±»çš„å®ç°è¢«æ›¿æ¢äº†ï¼Œå…·ä½“è°ƒç”¨çš„æ—¶å€™ï¼Œä¼šè°ƒç”¨ä¸€ä¸ªStringFactoryæ¥ç”Ÿæˆä¸€ä¸ªStringï¼Œä¸è¿‡ä¸€ç›´æ²¡æœ‰æ‰¾åˆ°å…¥å£</p>
<pre><code> public String(char[] data) {
throw new UnsupportedOperationException(&quot;Use StringFactory instead.&quot;);
}
</code></pre>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œandroid ä¸‹ String ç±»å®ç°ä¸ Oracle çš„å®ç°å®Œå…¨ä¸ä¸€æ ·</p>
</li>
<li>
<p>å…¨çƒåŒ–é—®é¢˜ï¼Œè¯­è¨€åˆ‡æ¢<br>
<code>compileSdkVersion 23</code><br>
ç‰ˆæœ¬çš„æ—¶å€™éœ€è¦<br>
<code>resources.updateConfiguration(config, dm);</code><br>
ä¸ç„¶æ²¡ç”¨<br>
http://blog.csdn.net/sodino/article/details/6596709</p>
</li>
<li>
<p>ä¸‰æ˜Ÿçš„å‚»é€¼ï¼Œæ‹ç…§ä¼šæ—‹è½¬ï¼Œå¯¼è‡´åŸ<code>activity</code>é‡ç”Ÿï¼Œä»è€Œè§¦å‘<code>onCreate()</code><br>
åœ¨<code>AndroidManifest.xml</code>å¯¹åº”çš„<code>activity</code>å†™ä¸Š Â· <code>android:screenOrientation=&quot;landscape&quot;</code><br>
ï¼ˆlandscape = æ¨ªå‘ portrait = çºµå‘ï¼‰<br>
<code>android:configChanges=&quot;keyboardHidden|orientation&quot;</code></p>
</li>
<li>
<p>é‡åˆ°ä¸€ä¸ªå‚»é€¼çš„bugï¼Œå‰å‡ å¤©è¿˜å¯ä»¥æ„å»ºï¼Œæ”¾å®Œå‡ä»¥åï¼Œè¿è¡Œé¡¹ç›®çªç„¶æŠ¥é”™ï¼Œåº”è¯¥ä¸æˆ‘ç”¨çš„studio beat ç‰ˆç›¸å…³ï¼š<br>
æŠ¥é”™ä¸ºï¼š<code>Plugin is too old,please update to a more recent version,or set ANDROID_DAILY_OVERRIDE environment variable to &quot;XXXXX&quot;</code><br>
ç‚¹ä¸‹é¢çš„<code>Fix plugin version and sync project</code>ä¾æ—§æŠ¥é”™ï¼Œæ— ç”¨ã€‚<br>
åæ¥å‘ç°æ˜¯build.gradle é‡Œclasspathçš„é—®é¢˜ æˆ‘ç”¨çš„æ˜¯ 2.0.0 alpha1 æ”¹æˆ1.2.3<br>
æˆ–è€…æ”¹æˆæœ€æ–°çš„ alpha3ï¼Œç­‰å¾…ä¸‹è½½é‡æ–°æ„å»ºå°±å¯ä»¥äº†<br>
<code>com.android.tools.build:gradle:1.2.3</code><br>
å»ºè®®ç”¨1.2.3ï¼Œalpha3éœ€è¦æ›´æ–°2.8çš„gradleï¼Œåˆè¦æ›´æ–°ï¼Œæœ‰ç‚¹éº»çƒ¦</p>
</li>
<li>
<p>&quot;Bitmap too large to be uploaded into a texture&quot;<br>
è§£å†³æ–¹æ¡ˆï¼Œé‡æ–°è®¾ç½® bitmap å¤§å°ï¼ŒOpenGL limit æ˜¯ 2048 * 2048</p>
</li>
<li>
<p><code>kitkat</code>ä¹‹å‰<code>listview</code>çš„<code>addHeaderView()</code>éœ€è¦åœ¨setAdapterä¹‹å‰è°ƒç”¨ï¼Œ<br>
<code>kitkat</code>ä¹‹å<code>addHeaderView()</code>å¯ä»¥åœ¨å‰åè°ƒç”¨</p>
</li>
<li>
<p><code>RecyclerView</code> 23.1.1 ç‰ˆæœ‰ bugï¼Œè§£å†³æ–¹æ¡ˆï¼Œé‡å†™ <code>LineaLayoutManager</code> çš„ <code>onLayoutChildren</code></p>
<pre><code>@Override
public void onLayoutChildren(RecyclerView.Recycler recycler,    RecyclerView.State state) {
try {
    super.onLayoutChildren(recycler, state);
} catch (IndexOutOfBoundsException e) {
    Log.e(&quot;probe&quot;, &quot;meet a IOOBE in RecyclerView&quot;);
}
</code></pre>
<p>}</p>
<p><code>java.lang.IndexOutOfBoundsException: Inconsistency detected. Invalid view holder adapter positionViewHolder</code></p>
<p>http://stackoverflow.com/questions/31759171/recyclerview-and-java-lang-indexoutofboundsexception-inconsistency-detected-in</p>
</li>
<li>
<p>Fresco åœæ­¢æ¢å¤åŠ è½½<br>
<code>Fresco.getImagePipeline().resume();</code><br>
<code>Fresco.getImagePipeline().paused();</code></p>
</li>
<li>
<p>ä¸çŸ¥é“ä¸ºä»€ä¹ˆçš„bugï¼Œè®°å½•ï¼Œå­å¸ƒå±€ marginBottom æ²¡ä½œç”¨ï¼Œçˆ¶çº§å¸ƒå±€ä¸­ paddingBottom å¯ä»¥ç”¨</p>
<pre><code>    &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
    &lt;android.support.v7.widget.CardView xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;
    android:id=&quot;@+id/item_tc_home_root_cv&quot;
    android:layout_marginBottom=&quot;16dp&quot;
    app:cardBackgroundColor=&quot;@color/color_white&quot;
    android:orientation=&quot;vertical&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;wrap_content&quot; &gt;
    &lt;LinearLayout
    android:orientation=&quot;vertical&quot;
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;wrap_content&quot;&gt;
        &lt;LinearLayout
            android:layout_width=&quot;match_parent&quot;
            android:layout_height=&quot;200dp&quot;/&gt;
        &lt;RelativeLayout
            android:paddingBottom=&quot;16dp&quot;
            android:layout_width=&quot;match_parent&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:background=&quot;#ffffff&quot;&gt;
            &lt;LinearLayout
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:layout_marginLeft=&quot;50dp&quot;
                android:layout_marginTop=&quot;10dp&quot;
                android:id=&quot;@+id/linear_one&quot;
                android:orientation=&quot;vertical&quot;&gt;
                &lt;com.facebook.drawee.view.SimpleDraweeView
                    app:placeholderImage=&quot;@mipmap/icon_head_image&quot;
                    app:roundAsCircle=&quot;true&quot;
                    android:layout_width=&quot;60dp&quot;
                    android:layout_height=&quot;60dp&quot;
                    android:src=&quot;@mipmap/icon_head_image&quot;
                    android:id=&quot;@+id/avatar_iv&quot; /&gt;
            &lt;/LinearLayout&gt;
            &lt;LinearLayout
                android:layout_width=&quot;200dp&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:layout_alignParentRight=&quot;true&quot;
                android:orientation=&quot;horizontal&quot;
                android:layout_marginTop=&quot;16dp&quot;
                android:layout_marginRight=&quot;16dp&quot;
                android:id=&quot;@+id/linear_two&quot;
                android:weightSum=&quot;3&quot;&gt;
                &lt;TextView
                    android:layout_width=&quot;0dp&quot;
                    android:layout_height=&quot;wrap_content&quot;
                    android:layout_weight=&quot;1&quot;
                    android:textSize=&quot;16sp&quot;
                    android:textColor=&quot;#ff467d&quot;
                    android:id=&quot;@+id/post_count_tv&quot;
                    android:text=&quot;45&quot;
                    android:gravity=&quot;center&quot;/&gt;
                &lt;TextView
                    android:layout_width=&quot;0dp&quot;
                    android:layout_height=&quot;wrap_content&quot;
                    android:layout_weight=&quot;1&quot;
                    android:textSize=&quot;16sp&quot;
                    android:textColor=&quot;#ff467d&quot;
                    android:id=&quot;@+id/fans_count_tv&quot;
                    android:text=&quot;2322&quot;
                    android:gravity=&quot;center&quot;/&gt;
                &lt;TextView
                    android:layout_width=&quot;0dp&quot;
                    android:layout_height=&quot;wrap_content&quot;
                    android:layout_weight=&quot;1&quot;
                    android:textSize=&quot;16sp&quot;
                    android:textColor=&quot;#ff467d&quot;
                    android:id=&quot;@+id/follow_count_tv&quot;
                    android:text=&quot;172&quot;
                    android:gravity=&quot;center&quot;/&gt;
            &lt;/LinearLayout&gt;
            &lt;LinearLayout
                android:layout_width=&quot;200dp&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:orientation=&quot;horizontal&quot;
                android:layout_alignParentRight=&quot;true&quot;
                android:layout_below=&quot;@+id/linear_two&quot;
                android:layout_marginTop=&quot;16dp&quot;
                android:layout_marginRight=&quot;16dp&quot;
                android:id=&quot;@+id/linear_three&quot;
                android:weightSum=&quot;3&quot;
                &gt;
        &lt;TextView
            android:layout_width=&quot;0dp&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_weight=&quot;1&quot;
            android:textColor=&quot;#999999&quot;
            android:textSize=&quot;12sp&quot;
            android:text=&quot;å¸–å­&quot;
            android:gravity=&quot;center&quot;/&gt;
        &lt;TextView
            android:layout_width=&quot;0dp&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_weight=&quot;1&quot;
            android:textColor=&quot;#999999&quot;
            android:textSize=&quot;12sp&quot;
            android:text=&quot;ç²‰ä¸&quot;
            android:gravity=&quot;center&quot;/&gt;
        &lt;TextView
            android:layout_width=&quot;0dp&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_weight=&quot;1&quot;
            android:textColor=&quot;#999999&quot;
            android:textSize=&quot;12sp&quot;
            android:text=&quot;å…³æ³¨&quot;
            android:gravity=&quot;center&quot;/&gt;
    &lt;/LinearLayout&gt;
    &lt;TextView
        android:layout_marginLeft=&quot;48dp&quot;
        android:layout_below=&quot;@+id/linear_one&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_marginTop=&quot;16dp&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:singleLine=&quot;true&quot;
        android:textSize=&quot;18sp&quot;
        android:gravity=&quot;center&quot;
        android:id=&quot;@+id/oldDriver_name_tv&quot;
        android:textColor=&quot;#4c4c4c&quot;
        android:text=&quot;å¤§å“¥&quot;/&gt;
    &lt;TextView
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:layout_below=&quot;@+id/oldDriver_name_tv&quot;
        android:layout_marginLeft=&quot;16dp&quot;
        android:layout_marginRight=&quot;16dp&quot;
        android:text=&quot;cos çˆ±å¥½è€…ã€æˆ‘çš„åšå®¢åœ°å€ï¼šhttp:www.....&quot;
        android:textColor=&quot;#999999&quot;
        android:textSize=&quot;14sp&quot;
        android:id=&quot;@+id/personal_description_tv&quot;
        android:layout_marginTop=&quot;16dp&quot; /&gt;
    &lt;LinearLayout
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:layout_below=&quot;@+id/personal_description_tv&quot;
        android:layout_marginTop=&quot;16dp&quot;
        android:gravity=&quot;center&quot;&gt;
        &lt;ImageView
            android:layout_width=&quot;114dp&quot;
            android:layout_height=&quot;48dp&quot;
            android:src=&quot;@mipmap/follow&quot;
            android:id=&quot;@+id/follow_iv&quot;/&gt;
    &lt;/LinearLayout&gt;

&lt;/RelativeLayout&gt;
</code></pre>
</li>
<li>
<p><code>ICCP: Not recognizing known sRGB profile that has been edited</code> é”™è¯¯ï¼Œå¥½åƒæ˜¯<code>png</code>æ˜¯<code>sRGB</code>å¯¼è‡´çš„é”™è¯¯ï¼Œè§£å†³æ–¹æ¡ˆåœ¨<code>buildToolsVersion</code>ä¸‹é¢åŠ ï¼š</p>
<pre><code>aaptOptions.cruncherEnabled = false
aaptOptions.useNewCruncher = false
</code></pre>
</li>
</ol>
<p>å¯ä»¥å–æ¶ˆ<code>Android Studio</code>å¯¹å›¾ç‰‡åˆæ³•æ€§çš„æ£€æŸ¥(å‚è€ƒï¼šhttp://my.oschina.net/1pei/blog/479162)</p>
<ol>
<li>debug.keystore é—®é¢˜ï¼ˆä¸åŒå¯ä»¥è·‘ä¸åŒapkï¼Œä¸è¿‡å¤§éƒ¨åˆ†apkä¼šæœ‰éªŒè¯ï¼Œå›åˆ°å¯¼è‡´APPè¿è¡Œå¤±è´¥ï¼‰</li>
<li>éšå¼è°ƒç”¨åœ¨5.0åä¸å…è®¸ï¼Œä¸¤ç§æ–¹æ¡ˆï¼š</li>
</ol>
<ul>
<li>è¯¥æˆæ˜¾å¼è°ƒç”¨</li>
</ul>
<pre><code>    Intent serviceIntent = new Intent(context,MyService.class);
    context.startService(serviceIntent);
</code></pre>
<ul>
<li>åŠ ä¸ŠåŒ…å</li>
</ul>
<pre><code>        PackageManager pm = context.getPackageManager();
        List&lt;ResolveInfo&gt; resolveInfoList = pm.queryIntentServices(implicitIntent, 0);
        if (resolveInfoList == null || resolveInfoList.size() != 1) {
            return null;
        }
        ResolveInfo serviceInfo = resolveInfoList.get(0);
        ComponentName component = new ComponentName(serviceInfo.serviceInfo.packageName, serviceInfo.serviceInfo.name);
        Intent explicitIntent = new Intent(implicitIntent);
        explicitIntent.setComponent(component);
</code></pre>
<ol>
<li>service éœ€è¦å…ˆunbindï¼ˆå¦‚æœbindè¿‡çš„è¯ï¼‰ï¼Œä¸ç„¶æ— æ³•stopService</li>
<li>ExecutorService çš„ execute å’Œ submit æ–¹æ³•ï¼Œå‰è€…ä¼šå¾€å¤–éƒ¨æŠ›å‡ºé”™è¯¯ï¼Œåè€…ä¸ä¼šã€‚å‚è€ƒ<a href="https://segmentfault.com/a/1190000000669942">ExecutorServiceçš„å‘</a></li>
</ol>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ã€æ—§ã€‘å¼•ç”¨ä¼ é€’å’Œå€¼ä¼ é€’(pass by value vs pass by reference)]]></title>
        <id>https://flyer88.github.io/post/jiu-yin-yong-chuan-di-he-zhi-chuan-di-pass-by-value-vs-pass-by-reference/</id>
        <link href="https://flyer88.github.io/post/jiu-yin-yong-chuan-di-he-zhi-chuan-di-pass-by-value-vs-pass-by-reference/">
        </link>
        <updated>2020-06-15T09:44:08.000Z</updated>
        <content type="html"><![CDATA[<blockquote>
<p>å†™äº 2016 å¹´ 07 æœˆ 30 æ—¥</p>
</blockquote>
<ul>
<li>ä¸€. å€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹ï¼ˆæ­¤å¤„å…ˆä¸è€ƒè™‘Stringï¼‰çš„ä¼ é€’</li>
<li>äºŒ. Stringçš„é—®é¢˜ï¼š
<ul>
<li>
<ol>
<li>Stringé—®é¢˜æ¥æº</li>
</ol>
</li>
<li>2.è„‘æ´çŒœæƒ³å¯èƒ½æƒ…å†µ</li>
<li>3.å­—èŠ‚ç éªŒè¯</li>
<li>4.æœ€ç»ˆç»“è®º</li>
</ul>
</li>
</ul>
<p>å†™è¿™ä¸ªçš„åŸå› ä¸»è¦æ˜¯ä»Šå¤©çœ‹åˆ°äº†<a href="https://www.zhihu.com/question/31203609">çŸ¥ä¹çš„ä¸€ä¸ªé—®é¢˜</a>ï¼Œå‘ç°è‡ªå·±æœ‰äº›åœ°æ–¹æœ‰ç‚¹æ‡µé€¼ï¼Œå†™ä¸‹æ¥è®°å½•ä¸€ä¸‹ï¼Œ<a href="http://zhihu.com/question/31203609/answer/50992895">çŸ¥ä¹ä¸Šæ’åç¬¬ä¸€çš„ç­”æ¡ˆ</a>è¯´çš„å¾ˆæ¸…æ¥šï¼Œä¸è¿‡çœ‹äº†ä»¥åä¾æ—§æœ‰ç‚¹è¿·è¿·ç³Šç³Šï¼Œæ‰€ä»¥è‡ªå·±å†™äº†ä¸ªå‡ è¡Œä»£ç æµ‹è¯•ã€‚</p>
<p>é¦–å…ˆä¸Šä¸€ä¸ªï¼Œæ„Ÿè§‰æ¯”è¾ƒå¯¹çš„ç»“è®ºï¼š</p>
<p><strong>Horstmannçš„ã€Šjavaæ ¸å¿ƒæŠ€æœ¯ã€‹ï¼ˆä¸­æ–‡ç¬¬8ç‰ˆP115-P117ï¼‰åŸæ–‡æè¿°ï¼š</strong></p>
<p><strong>â€javaç¨‹åºè®¾è®¡è¯­è¨€æ€»æ˜¯é‡‡ç”¨å€¼è°ƒç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ–¹æ³•å¾—åˆ°çš„æ˜¯æ‰€æœ‰å‚æ•°å€¼çš„ä¸€ä¸ªæ‹·è´ï¼Œç‰¹åˆ«æ˜¯ï¼Œæ–¹æ³•ä¸èƒ½ä¿®æ”¹ä¼ é€’ç»™å®ƒçš„ä»»ä½•å‚æ•°å˜é‡çš„å†…å®¹ã€‚â€œ</strong></p>
<p><strong>â€æœ‰äº›ç¨‹åºå‘˜ï¼ˆç”šè‡³æ˜¯æœ¬ä¹¦çš„ä½œè€…ï¼‰ï¼Œè®¤ä¸ºjavaç¨‹åºè®¾è®¡è¯­è¨€å¯¹å¯¹è±¡é‡‡ç”¨çš„æ˜¯å¼•ç”¨è°ƒç”¨ï¼Œå®é™…ä¸Šè¿™ç§ç†è§£æ˜¯ä¸å¯¹çš„ã€‚â€</strong></p>
<p>ç„¶åè¡¥å……å‡ å¥æˆ‘çš„ç†è§£ï¼š</p>
<ol>
<li>é¦–å…ˆï¼ŒJavaåœ¨ä¼ é€’è¿‡ç¨‹ä¸­ï¼Œä¼ é€’çš„åªæœ‰å€¼ï¼Œä½†æ˜¯è¡¨ç°å‡ºæ¥çš„å½¢å¼ï¼Œå´æ—¢æœ‰å€¼ä¼ é€’ä¹Ÿæœ‰å¼•ç”¨ä¼ é€’ï¼Œå› æ­¤ï¼Œæ²¡å¿…è¦çº ç»“äºåå­—ï¼Œèƒ½ç†è§£åŸç†å³å¯ã€‚</li>
<li>åœ¨ä¼ é€’å¯¹è±¡è¿›å‡½æ•°æ—¶ï¼Œå¯¹è±¡çš„æ‰€æœ‰æ•°æ®ä¼šè¢«æ‹·è´åˆ°å±€éƒ¨å˜é‡ä¸­ï¼Œè¿™ä¹Ÿå°±å¯¼è‡´äº†å±€éƒ¨å˜é‡ä¿®æ”¹å…¶æˆå‘˜å˜é‡å€¼æ—¶ä¼šå¯¼è‡´åŸå§‹çš„å˜é‡çš„æˆå‘˜å˜é‡å€¼äº§ç”Ÿå“åº”çš„æ”¹å˜ï¼Œå› ä¸ºä»–ä»¬æŒæœ‰çš„æˆå‘˜å˜é‡çš„å¼•ç”¨æŒ‡å‘äº†åŒä¸€ä¸ªåœ°å€å—(å†…å­˜ç©ºé—´)ã€‚</li>
<li>è€Œå¯¹äºä¼ é€’8ç§åŸºæœ¬å˜é‡æ—¶ï¼Œä¹Ÿåªæ˜¯æ‹·è´äº†å€¼ï¼Œå› æ­¤å¯¹åŸºæœ¬å˜é‡å…¶æœ¬èº«çš„ä¿®æ”¹ï¼Œæ— æ³•å¯¼è‡´åŸå§‹å˜é‡çš„çš„ä¿®æ”¹ã€‚</li>
<li>ä¸è¿‡è¿™é‡Œéœ€è¦è€ƒè™‘ç‰¹æ®Šæƒ…å†µï¼Œå°±æ˜¯Stringï¼Œå…¶è¡¨ç°å½¢å¼å’Œ8ç§åŸºæœ¬å˜é‡ä¸€æ ·ï¼Œå…·ä½“ä¸‹æ–‡æœ‰åˆ†æï¼Œè€Œå¯¹äºStringä¸ºä½•è¦è¿™ä¹ˆåšï¼Œæˆ‘ä¹Ÿä¸æ¸…æ¥šï¼Œä¸æ˜¯å¾ˆæ‡‚ jvm å’Œ Java çš„è®¾è®¡ã€‚</li>
</ol>
<hr>
<hr>
<h2 id="ä¸€-å€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹æ­¤å¤„å…ˆä¸è€ƒè™‘stringçš„ä¼ é€’">ä¸€. å€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹ï¼ˆæ­¤å¤„å…ˆä¸è€ƒè™‘Stringï¼‰çš„ä¼ é€’ï¼š</h2>
<pre><code>public class Student {
    int age;
    String name;
}
public class TestReference {
    public static void main(String[] args){
        Student student = new Student();
        student.age = 10;
        System.out.println(student.age);//10
        addAge(student);
        System.out.println(student.age);//11
        addAge(student.age);
        System.out.println(student.age);//11
    }

    static public void addAge(Student paramStudent){
        paramStudent.age = 11;
    }

    static public void addAge(int paramAge){
        paramAge = 12;
    }
}
</code></pre>
<p>å¯¹ä»¥ä¸Šä»£ç è¿›è¡Œè§£é‡Š</p>
<ul>
<li>é¦–å…ˆ<code>addAge(student)</code>è°ƒç”¨çš„æ˜¯<code>addAge(Student paramStudent)</code>ï¼Œè¯¥éƒ¨åˆ†å…¶å®å¾ˆå¥½ç†è§£ï¼Œé¦–å…ˆï¼Œ<code>paramStudet</code>å¯¹è±¡ï¼Œæ‹·è´äº†ä¼ å…¥çš„<code>studet</code>å¯¹è±¡æ‰€æœ‰çš„æ•°æ®ï¼Œå› æ­¤<code>paramStudet</code>å®ƒæ‰€æŒ‡å‘çš„åœ°å€ï¼Œå…¶å®å’Œ<code>student</code>æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥ï¼Œå½“<code>paramStudent</code>æ”¹å˜å®ƒçš„<code>age</code>å€¼æ—¶ï¼Œå…¶è§¦å‘çš„æ“ä½œå’Œ<code>student</code>æ”¹å˜<code>age</code>çš„å€¼æ˜¯ä¸€æ ·çš„ ,å› ä¸ºä»–ä»¬éƒ½æŒ‡å‘äº†åŒä¸€ä¸ªåœ°å€å—ã€‚</li>
<li>å…¶æ¬¡<code>addAge(student.age)</code>è°ƒç”¨çš„æ˜¯<code>addAge(int paramAge)</code>ï¼Œä¹Ÿå¾ˆå¥½ç†è§£ï¼Œ<code>paramAge</code>ä¹Ÿåªæ˜¯æ‹·è´äº†<code>studet.age</code>çš„å€¼ï¼Œæ­¤å¤„ä¸º10ï¼Œç„¶åæ”¹å˜äº†<code>paramAge</code>çš„å€¼ï¼Œä½†æ­¤æ—¶<code>paramAge</code>ä¸å¼•ç”¨ç±»å‹ä¸åŒï¼Œå®ƒä¿å­˜çš„åªæœ‰ä¸€ä¸ªå€¼ï¼Œæ‰€ä»¥å…¶å®è¿™ä¸ª<code>parmaAge</code>ä½œä¸ºä¸€ä¸ªå±€éƒ¨å˜é‡ï¼Œå¹¶ä¸èƒ½å¯¹åŸæœ¬çš„<code>student.age</code>äº§ç”Ÿä»»ä½•å½±å“</li>
</ul>
<h2 id="äºŒ-stringçš„é—®é¢˜">äºŒ. Stringçš„é—®é¢˜ï¼š</h2>
<h3 id="1-stringé—®é¢˜æ¥æº">1. Stringé—®é¢˜æ¥æº</h3>
<p>ä¸Šé¢çš„ä¾‹å­å…¶å®å¾ˆå¥½ææ¸…æ¥šï¼Œä½†æ˜¯æˆ‘åœ¨ç¢°åˆ°Stringçš„æ—¶å€™å°±æœ‰ç‚¹æ‡µé€¼äº†,å¦‚æœè°ƒç”¨ä»¥ä¸‹æ–¹æ³•ï¼Œç»“æœä¼šå¦‚æ³¨é‡Šæ˜¾ç¤ºã€‚</p>
<pre><code>public static void main(String[] args){
    Student student = new Student();
    student.age = 10;
    student.name = &quot;dove&quot;;
    changeName(student);
    System.out.println(student.name);//dove_2
    changeName(student.name);
    System.out.println(student.name);//dove_2
    changeName2(student.name); 
    System.out.println(student.name);//dove_2         
}      
static void changeName(Student paramStudent){
    paramStudent.name = &quot;dove_2&quot;;
}
static void changeName(String paramName){
    paramName = &quot;dove_3&quot;;
}
static void changeName2(String paramName){
    paramName += &quot;233&quot;;
}
</code></pre>
<p><code>changeName2(String paramName)</code>æ­¤å¤„è®²é“ç†è¢«è°ƒç”¨ååº”è¯¥æ˜¯&quot;dove_2233&quot;,å› ä¸º<code>String</code>æ˜¯ä¸€ä¸ªå¼•ç”¨ç±»å‹,ä¹Ÿå°±æ˜¯è¯´æ­¤å¤„çš„<code>parmaName</code>åº”è¯¥æ˜¯æŒ‡å‘å’Œä¼ å…¥çš„å‚æ•°æŒ‡å‘äº†ç›¸åŒçš„ä¸€ä¸ªåœ°å€å—ï¼Œç„¶åå¯¹æŒ‡å‘çš„å†…å­˜è¿›è¡Œäº†ä¿®æ”¹,ç„¶è€Œç»“æœå¹¶ä¸æ˜¯,åŸå› å°±åœ¨äº<code>String</code>æ˜¯ä¸€ä¸ªä¸å¯å˜çš„ç±»å‹(ä¸ºå•¥ä¸å¯å˜å‘¢,å…·ä½“å¯ä»¥çœ‹<code>String</code>ç±»çš„å®ç°,å®ƒæ˜¯ä¸€ä¸ª<code>final class</code>,å¹¶ä¸”å…¶å†…éƒ¨æ­£çœŸä¿å­˜ç€å­—ç¬¦ä¸²çš„<code>value[]</code>ä¹Ÿæ˜¯ä¸å¯å˜çš„(<code>final</code>)ï¼Œæ‰€ä»¥æ„å‘³ç€ä¿®æ”¹<code>Sting</code>æ˜¯ä¸å¯èƒ½çš„)ã€‚</p>
<h3 id="2è„‘æ´çŒœæƒ³å¯èƒ½æƒ…å†µ">2.è„‘æ´çŒœæƒ³å¯èƒ½æƒ…å†µ</h3>
<p>æ‰€ä»¥çŒœæµ‹ä¸Šè¿°çš„<code>changeName2</code>è¿‡ç¨‹ç±»ä¼¼äº</p>
<pre><code>    FuckString fuckString = new FuckString();//paramName
    FuckString fuckString2 = new FuckString(fuckString);//æ„é€ å‡ºçš„æ–°çš„å€¼
    fuckString = fuckString2;//æŠŠparamNameæŒ‡å‘æ„é€ å‡ºçš„æ–°å€¼
</code></pre>
<p>ç„¶åï¼Œè¿™å°±æœ‰ç‚¹æƒ³ä¸é€šäº†ï¼Œä¸å¯å˜çš„ç±»å‹ï¼ŒString çš„ <code>+</code> æ˜¯æ€ä¹ˆå¼„çš„å‘¢ï¼Ÿæ‰“ä¸ªæ–­ç‚¹è¯•è¯•çœ‹ï¼Œå¼ºåˆ¶è¿›å…¥ï¼Œå‘ç°è·³è½¬åˆ°äº†StringBuilderçš„æ„é€ æ–¹æ³•é‡Œï¼Œè¿™è¯´æ˜åº”è¯¥æ˜¯æ„é€ äº†ä¸€ä¸ªæ–°çš„StringBuilderå¯¹è±¡ã€‚</p>
<figure data-type="image" tabindex="1"><img src="http://www.dove.farbox.com/java/_image/%E5%BC%95%E7%94%A8%E4%BC%A0%E9%80%92%E5%92%8C%E5%80%BC%E4%BC%A0%E9%80%92/19-58-14.jpg" alt="img" loading="lazy"></figure>
<p>åŒæ—¶ï¼Œåº•éƒ¨çš„Debugé‡ŒæŠ›å‡ºäº†ä¸ªé”™è¯¯ï¼Œè¯´æ˜¯æ— æ³•è·å–<code>StringBuilder.toString()</code>,ä¹Ÿå°±è¿›ä¸€æ­¥è¯æ˜æ­¤å¤„æœ‰æ–°çš„<code>String</code>çš„äº§ç”Ÿã€‚</p>
<figure data-type="image" tabindex="2"><img src="http://www.dove.farbox.com/java/_image/%E5%BC%95%E7%94%A8%E4%BC%A0%E9%80%92%E5%92%8C%E5%80%BC%E4%BC%A0%E9%80%92/19-58-59.jpg" alt="img" loading="lazy"></figure>
<p>åˆ°è¿™é‡ŒåŸºæœ¬ä¸Šå°±éªŒè¯äº†æˆ‘çš„çŒœæƒ³ï¼Œ<code>String</code> <code>+</code>ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„<code>String</code>å¯¹è±¡ï¼Œæ—¢ç„¶è¿™æ ·ï¼Œåç¼–è¯‘ä¸‹ï¼Œçœ‹ä¸‹å­—èŠ‚ç ï¼Œä¼°è®¡åŸºæœ¬å°±æå®šè¿™ä¸ªæ‡µé€¼çš„é—®é¢˜äº†ã€‚</p>
<h3 id="3å­—èŠ‚ç éªŒè¯">3.å­—èŠ‚ç éªŒè¯</h3>
<p>äºæ˜¯å°±å†™äº†ä»¥ä¸‹çš„ç±»ï¼Œç”¨æ¥éªŒè¯ï¼š</p>
<pre><code>public class Main {
    public static void main(String[] args){
        String s = &quot;dove&quot;;
        s += &quot;233&quot;;
    }
}
</code></pre>
<p>ç„¶åjavacï¼Œç„¶åjavap -cï¼Œçœ‹å­—èŠ‚ç ,å¦‚ä¸‹å›¾ã€‚</p>
<figure data-type="image" tabindex="3"><img src="http://www.dove.farbox.com/java/_image/%E5%BC%95%E7%94%A8%E4%BC%A0%E9%80%92%E5%92%8C%E5%80%BC%E4%BC%A0%E9%80%92/20-03-38.png" alt="img" loading="lazy"></figure>
<p>å°è¯•ç€è§£é‡Šä¸‹è¯¥éƒ¨åˆ†ä»£ç ï¼ˆä¸æ˜¯å¾ˆçœ‹çš„æ‡‚å­—èŠ‚ç ï¼Œæ‰€ä»¥æœ‰äº›è§£é‡Šå¯èƒ½ä¸æ˜¯å¾ˆè§„èŒƒï¼Œä¸è¿‡è®²é“ç†å¤§æ¦‚æ„æ€ä¸ä¼šå·®å¾ˆè¿œ)</p>
<ul>
<li><code>String s = &quot;dove&quot;;</code>éƒ¨åˆ†å­—èŠ‚ç åŠè§£é‡Š</li>
</ul>
<pre><code>       0: ldc           #2                  // String dove
       2: astore_1
</code></pre>
<p>ç¬¬0è¡Œï¼Œå°†ä¸€ä¸ªå¸¸é‡åŠ è½½åˆ°æ“ä½œæ•°æ ˆ,ä¹Ÿå°±æ˜¯æŠŠâ€œdoveâ€è¿™ç©æ„ï¼Œæ”¾è¿›äº†æ“ä½œæ•°æ ˆ(ä¹Ÿä¸çŸ¥é“æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Œè›¤è›¤)</p>
<p>ç¬¬2è¡Œï¼Œå°†ä¸€å·æ•°å€¼ï¼ˆä¸‹åˆ’çº¿1ä»£è¡¨ä¸€å·ï¼Œå¤§æ¦‚ç†è§£ï¼Œä¸æ˜¯å¾ˆå‡†ç¡®ï¼‰ä»æ“ä½œæ•°æ ˆå­˜å‚¨åˆ°å±€éƒ¨å˜é‡è¡¨ï¼Œè¯´ç™½äº†å°±æ˜¯æŠŠâ€œdoveâ€ç»™å­˜äº†èµ·æ¥ï¼Ÿ</p>
<ul>
<li><code>s += &quot;233&quot;;</code>éƒ¨åˆ†å­—èŠ‚ç åŠè§£é‡Š</li>
</ul>
<pre><code>       3: new           #3                  // class java/lang/StringBuilder
       6: dup
       7: invokespecial #4                  // Method java/lang/StringBuilder.&quot;&lt;init&gt;&quot;:()V
      10: aload_1    
      11: invokevirtual #5                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      14: ldc           #6                  // String 233
      16: invokevirtual #5                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      19: invokevirtual #7                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
</code></pre>
<p>ç¬¬3è¡Œï¼Œè¿™ä¸ªå¾ˆæ˜æ˜¾ï¼Œä¸googleä¹ŸçŸ¥é“ï¼Œ<code>new StringBuilder()</code>ï¼Œä¹Ÿå°±æ˜¯æäº†ä¸ª<code>StringBUilder</code>çš„å®ä¾‹ã€‚</p>
<p>ç¬¬6è¡Œï¼ŒJavaè™šæ‹Ÿæœºæä¾›äº†ä¸€äº›ç”¨äºç›´æ¥æ“ä½œæ“ä½œæ•°æ ˆï¼Œä¸æ˜¯å¾ˆæ‡‚ï¼Œè²Œä¼¼å¯¹æ•´ä½“ç†è§£å½±å“ä¸å¤§ï¼Œå…ˆè¿‡ã€‚</p>
<p>ç¬¬7è¡Œï¼Œinvokespecial è°ƒç”¨ä¸€äº›éœ€è¦ç‰¹æ®Šå¤„ç†çš„å®ä¾‹æ–¹æ³•ï¼ŒåŒ…æ‹¬å®ä¾‹åˆå§‹åŒ–æ–¹æ³•ã€ç§æœ‰æ–¹æ³•å’Œçˆ¶ç±»æ–¹æ³•ï¼Œæ­¤å¤„åº”è¯¥æ˜¯åœ¨åˆå§‹åŒ–StringBuilderå¯¹è±¡ã€‚</p>
<p>ç¬¬10è¡Œï¼Œå°†1å·å±€éƒ¨å˜é‡(ä¸‹åˆ’çº¿1æŒ‡ä»£ä¸€å·å˜é‡)åŠ è½½åˆ°æ“ä½œæ ˆï¼Œè¿™é‡Œåº”è¯¥æ˜¯æŒ‡â€œdoveâ€</p>
<p>ç¬¬11è¡Œï¼Œè°ƒç”¨å¯¹è±¡çš„å®ä¾‹æ–¹æ³•,æ­¤å¤„å°±æ˜¯è°ƒç”¨<code>StringBuilder.append</code>,ä¹Ÿå°±æ˜¯æŠŠâ€œdoveâ€åŠ åˆ°äº†<code>StringBuilder</code>ä¸­</p>
<p>ç¬¬14è¡Œï¼Œå°†ä¸€ä¸ªå¸¸é‡åŠ è½½åˆ°æ“ä½œæ•°æ ˆï¼Œå°±æ˜¯æŠŠâ€œ233â€è½½å…¥</p>
<p>ç¬¬16è¡Œï¼Œè°ƒç”¨å¯¹è±¡çš„å®ä¾‹æ–¹æ³•,æ­¤å¤„å°±æ˜¯è°ƒç”¨<code>StringBuilder.append</code>ï¼ŒæŠŠâ€œ233â€ç»™åŠ åˆ°â€œStringBuilderâ€ä¸­</p>
<p>ç¬¬19è¡Œï¼Œè°ƒç”¨å¯¹è±¡çš„å®ä¾‹æ–¹æ³•,æ­¤å¤„å°±æ˜¯è°ƒç”¨<code>StringBuilder.toString</code>ï¼Œè€Œè¯¥æ–¹æ³•ï¼Œä¼šè§¦å‘<code>new String()</code>çš„æ“ä½œï¼Œå› æ­¤ï¼Œä¼šè¿”è¿˜ä¸€ä¸ªæ–°çš„<code>String</code>å¯¹è±¡</p>
<h3 id="4æœ€ç»ˆç»“è®º">4.æœ€ç»ˆç»“è®ºï¼š</h3>
<p>ä»è„‘æ´æ–­ç‚¹ä»¥åŠæœ€åçš„å­—èŠ‚ç åˆ†æå¯ä»¥çœ‹å‡ºï¼Œ<code>s +=&quot;233&quot;</code>,ä¼šå¯¼è‡´ä¸€ä¸ªæ–°çš„Stringå¯¹è±¡ç”Ÿæˆï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè°ƒç”¨<code>changeName2(String paramName)</code>ä¼šä½¿å¾—<code>paramName</code>æŒ‡å‘ä¸€ä¸ªæ–°çš„Stringå¯¹è±¡ï¼Œè¿™æ ·å°±æ„å‘³ç€ï¼Œå¯¹è¯¥æ•°æ®çš„æ”¹å˜å¹¶ä¸ä¼šå½±å“æœ¬èº«<code>student.name</code>çš„å€¼,ç”±æ­¤ï¼ŒStringæ‡µé€¼çš„é—®é¢˜ä¹Ÿè§£å†³äº†ã€‚</p>
<hr>
<hr>
<p>ä»¥ä¸Šï¼Œå°±æ˜¯æ•´ä¸ªå…³äºJavaå¼•ç”¨ä¼ é€’å’Œå€¼ä¼ é€’çš„ç†è§£ï¼Œæœ‰è¯´çš„ä¸å¯¹çš„ï¼Œæœ›æŒ‡æ­£ã€‚</p>
]]></content>
    </entry>
</feed>